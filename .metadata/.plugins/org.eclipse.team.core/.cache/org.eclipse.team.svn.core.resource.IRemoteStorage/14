<?xml version="1.0" encoding="UTF-8"?>
<!--
* 파일명  : Bsnsreqstinqire_SQL.xml
* 설   명  : 사업신청관리 SQLMAP
* 시스템  : 한국무역협회 빅데이터 분석 시스템 구축
* since 2017. 8. 7.
* version 1.0
*
* Copyright ⓒ 2017 Daekyo CNS, All Rights Reserved.
* =========================================
* Modification Information 
* =========================================
*   수정일		 		수정자			수정내용
* =========================================
*  2017. 8.  21.			  		        신규생성
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.dkcns.kita.bsnsreqstmanage.bsnsreqstmanage.dao.BsnsreqstinqireDao">
<resultMap type="egovMap" id="egovMap">
	<result property="APP_HTML" column="APP_HTML" jdbcType="CLOB" javaType="java.lang.String" />
</resultMap>

	<!--##################################사업신청관리 조회 start##################################-->
	<sql id="bsnsCommCondition">
        		a.DELETE_YN = 'N' 
        AND	a.BIZ_SEQ=b.b_seq(+) 
        AND	a.CREATE_ID=c.USER_ID(+) 
    </sql>
	
	<sql id="bsnsSearchCondition">
		AND	(a.TEMP_YN <![CDATA[<> ]]>'Y' OR a.TEMP_YN IS NULL)  
		<if test='schBizTitle != null and schBizTitle !=""' >
			AND a.BIZ_TITLE LIKE '%' || #{schBizTitle} || '%'
		</if>
		<if test='schSDate != null and schSDate != ""'>
			AND a.BIZ_SDATE <![CDATA[>= ]]> TO_DATE( #{schSDate} ,'YYYY-MM-DD')
		</if>
		<if test='schEDate != null and schEDate != ""'>
			AND a.BIZ_EDATE <![CDATA[<= ]]> TO_DATE( #{schEDate} ,'YYYY-MM-DD')
		</if>
		<if test='schJoinSDate != null and schJoinSDate != ""'>
			AND a.BIZ_JOIN_SDATE <![CDATA[>= ]]> TO_DATE( #{schJoinSDate} ,'YYYY-MM-DD')
		</if>
		<if test='schJoinEDate != null and schJoinEDate != ""'>
			AND a.BIZ_JOIN_EDATE <![CDATA[<= ]]> TO_DATE( #{schJoinEDate} ,'YYYY-MM-DD')
		</if>
		<!-- <if test='schJoinDiv != null and schJoinDiv !=""'>
			<if test='schJoinDiv == "1"'>
				AND (
				          a.BIZ_JOIN_EDATE <![CDATA[< ]]> TO_CHAR(SYSDATE,'YYYY-MM-DD') 
	                      OR (
	                               a.BIZ_JOIN_EDATE <![CDATA[>= ]]> TO_CHAR(SYSDATE, 'YYYY-MM-DD') 
	                               AND a.END_YN = 'Y' 
	                               AND NVL(END_CNT, 0) > 0 
	                               AND a.END_CNT <![CDATA[<= ]]> (SELECT COUNT(*)FROM BIZ_APPLICATION)
	                           )
	                   ) 
			</if>
			<if test='schJoinDiv == "2"'>
			    AND TO_CHAR(SYSDATE,'YYYY-MM-DD') BETWEEN a.BIZ_JOIN_SDATE AND a.BIZ_JOIN_EDATE 
	            AND NOT (
	                              a.END_YN = 'Y' 
	                              AND NVL(a.END_CNT, 0) > 0 
	                              AND a.END_CNT <![CDATA[<= ]]> (SELECT COUNT(*) FROM BIZ_APPLICATION WHERE BIZ_SEQ = A.BIZ_SEQ)
	                          ) 
			</if>
			<if test='schJoinDiv == "3"'>
			     a.BIZ_JOIN_SDATE <![CDATA[> ]]> TO_CHAR(SYSDATE,'YYYY-MM-DD')  
			</if>
		</if> -->
		<if test='schDept != null and schDept != ""' >
			<if test='schDeptCd != null and schDeptCd != "" and schDept == "0"'>
			     AND a.DEPT_CD = #{schDeptCd}
			</if>
			<if test='userId != null and userId != "" and schDept == "2"'>
			     AND a.CREATE_ID = #{userId}
			</if>
		</if>
	</sql>
	
	<sql id="bsnsUnionCondition">
		AND	a.TEMP_YN = 'Y' 
		<if test='schCreateId != null and schCreateId != ""'>
			AND a.CREATE_ID = #{schCreateId}
		</if>
		<if test='schJoinDiv != null and schJoinDiv != ""'>
			<if test='schJoinDiv == "11"'>
				AND a.COMPLETE_YN = 'Y'
			</if>
		</if>
		<if test='schDept != null and schDept != ""' >
			<if test='schDeptCd != null and schDeptCd != "" and schDept == "0"'>
			     AND a.DEPT_CD = #{schDeptCd}
			</if>
			<if test='userId != null and userId != "" and schDept == "2"'>
			     AND a.CREATE_ID = #{userId}
			</if>
		</if>
	</sql>
	
	<sql id="selectBsnsreqstinqireListBody">
		
		SELECT * FROM (
		SELECT	a.BIZ_SEQ, 
                    a.BIZ_TITLE, 
                    TO_CHAR(a.BIZ_SDATE,'YYYY-MM-DD') AS BIZ_SDATE, 
                    TO_CHAR(a.BIZ_EDATE,'YYYY-MM-DD') AS BIZ_EDATE, 
                    TO_CHAR(a.BIZ_JOIN_SDATE,'YYYY-MM-DD') AS BIZ_JOIN_SDATE, 
                    TO_CHAR(a.BIZ_JOIN_EDATE,'YYYY-MM-DD') AS BIZ_JOIN_EDATE, 
                    CASE WHEN (a.BIZ_JOIN_SDATE <![CDATA[<= ]]> SYSDATE  AND a.BIZ_JOIN_EDATE <![CDATA[>= ]]> SYSDATE) THEN 'Y' ELSE 'N' END AS PROC_STATUS ,
                    a.BIZ_TIME, 
                    a.BIZ_PLACE, 
                    a.GUBUN, 
                    a.BIZ_TARGET, 
                    a.BIZ_CONTENT, 
                    a.TEMPLATE_GB,  
                    a.COMPLETE_YN, 
                    a.TEMPLATE_PATH, 
                    a.MOBILE_YN, 
                    a.DELETE_YN, 
                    a.CREATE_DATE, 
                    a.CREATE_ID, 
                    a.UPDATE_DATE, 
                    a.UPDATE_ID, 
                    a.DEPT_CD, 
                    a.EDIT_TYPE_YN, 
                    NVL(b.cnt,0) AS cnt, 
                    a.MTYPE_YN, 
                    a.TEMP_YN, 
                    a.BIZ_END_YN,
                    c.USER_NAME, 
                    b.MAX_ATTENDANCE_ORDER_NUM,
                    b.SATISFACTION_YN_CNT
              FROM	BIZ_MST a, 
                  (SELECT	BIZ_SEQ b_seq, 
                            count(APP_SEQ) AS cnt, 
                            MAX(TO_NUMBER(ATTENDANCE_ORDER_NUM)) MAX_ATTENDANCE_ORDER_NUM,
                            COUNT(SATISFACTION_YN) SATISFACTION_YN_CNT
                     FROM 	BIZ_APPLICATION 
                    GROUP BY BIZ_SEQ 
                   ) b, USER_INFO c 
              WHERE
                  <include refid="bsnsCommCondition" />
                  <include refid="bsnsSearchCondition" />
              UNION 
                    SELECT 	a.BIZ_SEQ, 
                           	a.BIZ_TITLE, 
                           	TO_CHAR(a.BIZ_SDATE,'YYYY-MM-DD') AS BIZ_SDATE , 
                           	TO_CHAR(a.BIZ_EDATE,'YYYY-MM-DD') AS BIZ_EDATE , 
                           	TO_CHAR(a.BIZ_JOIN_SDATE,'YYYY-MM-DD') AS BIZ_JOIN_SDATE , 
                            TO_CHAR(a.BIZ_JOIN_EDATE,'YYYY-MM-DD') AS BIZ_JOIN_EDATE , 
                            CASE WHEN (a.BIZ_JOIN_SDATE <![CDATA[<= ]]> SYSDATE  AND a.BIZ_JOIN_EDATE <![CDATA[>= ]]> SYSDATE) THEN 'Y' ELSE 'N' END AS PROC_STATUS ,
                            a.BIZ_TIME, 
                            a.BIZ_PLACE, 
                            a.GUBUN, 
                            a.BIZ_TARGET, 
                            a.BIZ_CONTENT, 
                            a.TEMPLATE_GB, 
                            a.COMPLETE_YN, 
                            a.TEMPLATE_PATH, 
                            a.MOBILE_YN, 
                            a.DELETE_YN, 
                            a.CREATE_DATE, 
                            a.CREATE_ID, 
                            a.UPDATE_DATE, 
                            a.UPDATE_ID, 
                            a.DEPT_CD, 
                            a.EDIT_TYPE_YN, 
                            NVL(b.cnt,0) AS cnt, 
                            a.MTYPE_YN, 
                            a.TEMP_YN, 
                            a.BIZ_END_YN,
                            c.USER_NAME, 
                            b.MAX_ATTENDANCE_ORDER_NUM,
                    		b.SATISFACTION_YN_CNT
                      FROM	BIZ_MST a, 
                           	(SELECT	BIZ_SEQ b_seq, 
                                   		count(APP_SEQ) AS cnt, 
                                   		MAX(TO_NUMBER(ATTENDANCE_ORDER_NUM)) MAX_ATTENDANCE_ORDER_NUM,
                                   		COUNT(SATISFACTION_YN) SATISFACTION_YN_CNT
                              FROM 	BIZ_APPLICATION 
                             GROUP BY BIZ_SEQ 
                            ) b, USER_INFO c 
                     WHERE 
                         <include refid="bsnsCommCondition" />
                         <include refid="bsnsUnionCondition" />
                         
                    )
                    WHERE 
			              1=1
			        <if test='schNoticeCon == "1"' >
						AND TEMP_YN = 'Y'
					</if>
					<if test='schNoticeCon == "2"' >
						AND BIZ_END_YN = 'Y'
					</if>
					<if test='schNoticeCon == "3"' >
						AND PROC_STATUS = 'Y'
					</if>
					<if test='schNoticeCon == "4"' >
						AND TEMP_YN <![CDATA[<>]]> 'Y' AND BIZ_END_YN <![CDATA[<>]]> 'Y' AND PROC_STATUS <![CDATA[<>]]> 'Y'
					</if>
	</sql>
	
	<!--사업신청조회 리스트  건수-->
	<select id="selectBsnsreqstinqireListCount" parameterType="bsnsReqDataVO" resultType="int">
		SELECT /* Bsnsreqstinqire.selectBsnsreqstinqireListCount */
			COUNT(*)
			FROM  
		       (SELECT ROWNUM AS RNUM, 
		              PS.* 
		         FROM
		              (SELECT
		              		 BIZ_SEQ
							,BIZ_TITLE
							,BIZ_SDATE
							,BIZ_EDATE
							,BIZ_JOIN_SDATE
							,BIZ_JOIN_EDATE
							,PROC_STATUS
							,BIZ_TIME
							,BIZ_PLACE
							,GUBUN
							,DECODE(GUBUN, '1', '기본형', '맞춤형' )  AS GUBUN_NM
							,BIZ_TARGET
							,BIZ_CONTENT
							,TEMPLATE_GB
							,COMPLETE_YN
							,DECODE(COMPLETE_YN, 'Y', '완료', 'N', '진행중', '' ) AS BIZ_STATUS_NM
							,TEMPLATE_PATH
							,MOBILE_YN
							,DELETE_YN
							,CREATE_DATE
							,CREATE_ID
							,UPDATE_DATE
							,UPDATE_ID
							,DEPT_CD
							,EDIT_TYPE_YN
							,CNT
							,MTYPE_YN
							,TEMP_YN
							,BIZ_END_YN 
							,USER_NAME
							,DECODE(TRIM(MAX_ATTENDANCE_ORDER_NUM), null, '0',  TRIM(MAX_ATTENDANCE_ORDER_NUM)) AS MAX_ATTENDANCE_ORDER_NUM
							,CASE 
					        WHEN SATISFACTION_YN_CNT  <![CDATA[>]]> 0 
					         THEN 6 
					        WHEN COMPLETE_YN = 'Y' 
					         THEN 5 
					        WHEN MAX_ATTENDANCE_ORDER_NUM <![CDATA[>]]> 0 
					         THEN 4 
					        WHEN CNT > 0 
					         THEN 3 
					        WHEN MAKETING_CNT > 0 
					         THEN 2 
					          ELSE 1 
					        END PROC_STEP
					        ,CASE 
					        WHEN SATISFACTION_YN_CNT <![CDATA[>]]> 0 
					         THEN '만족도조사 실시' 
					        WHEN COMPLETE_YN = 'Y' 
					         THEN '사업완료' 
					        WHEN MAX_ATTENDANCE_ORDER_NUM <![CDATA[>]]> 0 
					         THEN '사업수행(참가자 선별)'
					        WHEN CNT <![CDATA[>]]> 0 
					         THEN '사업참가자 현황' 
					        WHEN MAKETING_CNT <![CDATA[>]]> 0 
					         THEN '마케팅 실시' 
					          ELSE '온라인 사업등록'
					        END PROC_STEP_NM
		         FROM 
		         	(SELECT ROWNUM AS RNUM, 
		              AA.* , 
		              (SELECT COUNT(*) MAKETING_CNT 
		                FROM MARKETING_KEY 
		               WHERE BIZ_SEQ = AA.BIZ_SEQ 
		              ) MAKETING_CNT
		                FROM 
		                     (
		                     	<include refid="selectBsnsreqstinqireListBody" />
		                    ORDER BY BIZ_SDATE DESC, BIZ_SEQ DESC   
		                        ) 
		                        AA 
		                  ) BB 
		             ) PS 
		        WHERE 
		        	1=1
		        	<if test='schBizStatusDiv != null and schBizStatusDiv != "" and schBizStatusDiv != "0" '>
		        		AND PS.PROC_STEP = #{schBizStatusDiv} 
		        	</if>
		        	<if test='schBizStatusList != null and schBizStatusList != ""'>
		        		AND PS.PROC_STEP IN
		        		<foreach collection="schBizStatusList" item="item" index="index" separator="," open="(" close=")">
			                 #{item}
			            </foreach>
		        	</if>  
		       ) RT 
	</select>
	
	<!--사업신청조회 리스트-->
	<select id="selectBsnsreqstinqireList"  parameterType="bsnsReqDataVO" resultType="egovMap">
	    SELECT * 
       /* Bsnsreqstinqire.selectBsnsreqstinqireList */ 
		  FROM  
		       (SELECT ROWNUM AS RNUM, 
		              PS.* 
		         FROM
		              (SELECT
		              		 BIZ_SEQ
							,BIZ_TITLE
							,BIZ_SDATE
							,BIZ_EDATE
							,BIZ_JOIN_SDATE
							,BIZ_JOIN_EDATE
							,PROC_STATUS
							,BIZ_TIME
							,BIZ_PLACE
							,GUBUN
							,DECODE(GUBUN, '1', '기본형', '맞춤형' )  AS GUBUN_NM
							,BIZ_TARGET
							,BIZ_CONTENT
							,TEMPLATE_GB
							,COMPLETE_YN
							,DECODE(COMPLETE_YN, 'Y', '완료', 'N', '진행중', '' ) AS BIZ_STATUS_NM
							,TEMPLATE_PATH
							,MOBILE_YN
							,DELETE_YN
							,CREATE_DATE
							,CREATE_ID
							,UPDATE_DATE
							,UPDATE_ID
							,DEPT_CD
							,EDIT_TYPE_YN
							,CNT
							,MTYPE_YN
							,TEMP_YN
							,BIZ_END_YN 
							,USER_NAME
							,DECODE(TRIM(MAX_ATTENDANCE_ORDER_NUM), null, '0',  TRIM(MAX_ATTENDANCE_ORDER_NUM)) AS MAX_ATTENDANCE_ORDER_NUM
							,CASE 
					        WHEN SATISFACTION_YN_CNT  <![CDATA[>]]> 0 
					         THEN 6 
					        WHEN COMPLETE_YN = 'Y' 
					         THEN 5 
					        WHEN MAX_ATTENDANCE_ORDER_NUM <![CDATA[>]]> 0 
					         THEN 4 
					        WHEN CNT > 0 
					         THEN 3 
					        WHEN MAKETING_CNT > 0 
					         THEN 2 
					          ELSE 1 
					        END PROC_STEP
					        ,CASE 
					        WHEN SATISFACTION_YN_CNT <![CDATA[>]]> 0 
					         THEN '만족도조사 실시' 
					        WHEN COMPLETE_YN = 'Y' 
					         THEN '사업완료' 
					        WHEN MAX_ATTENDANCE_ORDER_NUM <![CDATA[>]]> 0 
					         THEN '사업수행(참가자 선별)'
					        WHEN CNT <![CDATA[>]]> 0 
					         THEN '사업참가자 현황' 
					        WHEN MAKETING_CNT <![CDATA[>]]> 0 
					         THEN '마케팅 실시' 
					          ELSE '온라인 사업등록'
					        END PROC_STEP_NM
		         FROM 
		         	(SELECT ROWNUM AS RNUM, 
		              AA.* , 
		              (SELECT COUNT(*) MAKETING_CNT 
		                FROM MARKETING_KEY 
		               WHERE BIZ_SEQ = AA.BIZ_SEQ 
		              ) MAKETING_CNT
		                FROM 
		                     (
		                     	<include refid="selectBsnsreqstinqireListBody" />
		                    ORDER BY BIZ_SDATE DESC, BIZ_SEQ DESC   
		                        ) 
		                        AA 
		                  ) BB 
		             ) PS 
		        WHERE 
		        	1=1
		        	<if test='schBizStatusDiv != null and schBizStatusDiv != "" and schBizStatusDiv != "0" '>
		        		AND PS.PROC_STEP = #{schBizStatusDiv} 
		        	</if>
		        	<if test='schBizStatusList != null and schBizStatusList != ""'>
		        		AND PS.PROC_STEP IN
		        		<foreach collection="schBizStatusList" item="item" index="index" separator="," open="(" close=")">
			                 #{item}
			            </foreach>
		        	</if>  
		       ) RT 
		 WHERE RNUM BETWEEN #{firstIndex}+1 AND #{lastIndex}
	</select>
	<!--##################################사업신청관리 조회 end##################################-->
	
	<!--##################################사업상태 모니터링 팝업 Start##################################-->
	
		<!--온라인 사업등록 조회 Start-->
		<select id="selectBizRegistInfo"  parameterType="bsnsReqDataVO" resultType="egovMap">
			SELECT  /* Bsnsreqstinqire.selectBizRegistInfo */
				   BB.*, 
			       CASE 
			           WHEN SATISFACTION_YN_CNT <![CDATA[>]]> 0 
			           THEN 6 
			           WHEN COMPLETE_YN = 'Y' 
			           THEN 5 
			           WHEN ATTENDANCE_ORDER_NUM_CNT <![CDATA[>]]> 0 
			           THEN 4 
			           WHEN CNT <![CDATA[>]]> 0 
			           THEN 3 
			           WHEN MAKETING_CNT <![CDATA[>]]> 0 
			           THEN 2 
			           ELSE 1 
			       END PROC_STEP, 
			       CASE 
			           WHEN TEMP_YN = 'Y' 
			           THEN '임시저장' 
			           WHEN BIZ_END_YN = 'Y' 
			           THEN '공지내림' 
			           WHEN PROC_STATUS = 'Y' 
			           THEN '공지중' 
			           ELSE '공지종료' 
			       END PROC_STATUS_NM 
			  FROM 
			       (SELECT AA.* , 
			              NVL(CNT,0) CNT , 
			              NVL ( SATISFACTION_YN_CNT, 0 ) SATISFACTION_YN_CNT , 
			              NVL ( ATTENDANCE_ORDER_NUM_CNT, 0 ) ATTENDANCE_ORDER_NUM_CNT , 
			              (SELECT COUNT(*) MAKETING_CNT 
			                FROM MARKETING_KEY 
			               WHERE BIZ_SEQ = AA.BIZ_SEQ
			              ) MAKETING_CNT , 
			              NVL(PROC_STATUS,'N' ) PROC_STATUS 
			         FROM 
			              (SELECT A.*, 
			                     ROWNUM AS RNUM 
			                FROM 
			                     (SELECT BIZ_SEQ, 
			                            BIZ_TITLE, 
			                            TO_CHAR(BIZ_SDATE,'YYYY-MM-DD') AS BIZ_SDATE , 
			                            TO_CHAR(BIZ_EDATE,'YYYY-MM-DD') AS BIZ_EDATE , 
			                            TO_CHAR(BIZ_JOIN_SDATE,'YYYY-MM-DD') AS BIZ_JOIN_SDATE , 
			                            TO_CHAR(BIZ_JOIN_EDATE,'YYYY-MM-DD') AS BIZ_JOIN_EDATE , 
			                            BIZ_TIME, 
			                            BIZ_PLACE, 
			                            GUBUN, 
			                            BIZ_TARGET, 
			                            BIZ_CONTENT, 
			                            TEMPLATE_GB, 
			                            TEMPLATE_PATH, 
			                            MOBILE_YN, 
			                            DELETE_YN, 
			                            TO_CHAR(CREATE_DATE,'YYYY-MM-DD HH24:MI:SS') CREATE_DATE, 
			                            CREATE_ID, 
			                            UPDATE_DATE, 
			                            UPDATE_ID, 
			                            DEPT_CD, 
			                            NVL(MTYPE_YN,'N') MTYPE_YN, 
			                            TEMP_YN, 
			                            COMPLETE_YN, 
			                            BIZ_END_YN, 
			                            COUNT (1) OVER (PARTITION BY '') TOTALCNT 
			                       FROM BIZ_MST A 
			                      WHERE DELETE_YN = 'N' 
			                            AND BIZ_SEQ = #{bizSeq}
			                   ORDER BY BIZ_SEQ DESC 
			                     ) A 
			              ) AA , 
			              (SELECT COUNT(APP_SEQ) AS CNT, 
			                     BIZ_SEQ 
			                FROM BIZ_APPLICATION 
			               WHERE DELETE_YN = 'N' 
			               GROUP BY BIZ_SEQ
			              ) A , 
			              (SELECT COUNT(SATISFACTION_YN) SATISFACTION_YN_CNT, 
			                     BIZ_SEQ 
			                FROM BIZ_APPLICATION 
			               WHERE DELETE_YN = 'N' 
			                     AND SATISFACTION_YN = 'Y' 
			               GROUP BY BIZ_SEQ 
			              ) C , 
			              (SELECT COUNT(ATTENDANCE_ORDER_NUM) ATTENDANCE_ORDER_NUM_CNT , 
			                     BIZ_SEQ 
			                FROM BIZ_APPLICATION 
			               WHERE DELETE_YN = 'N' 
			                     AND ATTENDANCE_ORDER_NUM IS NOT NULL 
			               GROUP BY BIZ_SEQ
			              ) D , 
			              (SELECT 'Y' PROC_STATUS , 
			                     BIZ_SEQ 
			                FROM BIZ_MST B 
			               WHERE TO_CHAR(BIZ_JOIN_SDATE, 'YYYY-MM-DD') <![CDATA[<=]]> TO_CHAR(SYSDATE, 'YYYY-MM-DD') 
			                     AND TO_CHAR(BIZ_JOIN_EDATE, 'YYYY-MM-DD') <![CDATA[>=]]> TO_CHAR(SYSDATE, 'YYYY-MM-DD') 
			              ) E 
			        WHERE 1= 1 
			              AND AA.BIZ_SEQ = A.BIZ_SEQ(+) 
			              AND AA.BIZ_SEQ = C.BIZ_SEQ(+) 
			              AND AA.BIZ_SEQ = D.BIZ_SEQ(+) 
			              AND AA.BIZ_SEQ = E.BIZ_SEQ(+)  
			     ORDER BY AA.BIZ_SEQ DESC 
			       ) BB  
		</select>
		<!--온라인 사업등록 조회 End-->
		
		<!--마케팅실시 조회 Start-->
		<select id="selectMarketingInfo"  parameterType="bsnsReqDataVO" resultType="egovMap">
			SELECT  /* Bsnsreqstinqire.selectMarketingInfo */
					   TOTALCNT, 
				       SEQ, 
				       TRADE_ID ,
				       SERVICE_NM, 
				       SERVICE_DESC , 
				       SERVICE_SDATE , 
				       SERVICE_EDATE, 
				       GET_DEPT_NAME(DEPT_CD) DEPT_CD, 
				       GET_USERNM_BY_ID(REG_ID ) REG_ID, 
				       SMS_CNT, 
				       FAX_CNT, 
				       MAIL_CNT, 
				       SVY_CNT, 
				       UP_CNT, 
				       MEDIA_DATE, 
				       DEMAND_DATE, 
				       BIGGERDATE, 
				       STATUS, 
				       EDATE 
				  FROM 
				       (SELECT ROWNUM AS RNUM, 
				              TOTALCNT, 
				              SEQ, 
				              TRADE_ID ,
				              SERVICE_NM, 
				              SERVICE_DESC , 
				              SERVICE_SDATE , 
				              SERVICE_EDATE, 
				              DEPT_CD ,
				              REG_ID , 
				              SMS_CNT , 
				              FAX_CNT, 
				              MAIL_CNT, 
				              SVY_CNT, 
				              UP_CNT, 
				              MEDIA_DATE, 
				              DEMAND_DATE, 
				              BIGGERDATE, 
				              STATUS, 
				              EDATE 
				         FROM 
				              (SELECT COUNT (1) OVER (PARTITION BY '') TOTALCNT, 
				                     AA.SEQ, 
				                     TRADE_ID ,
				                     SERVICE_NM, 
				                     SERVICE_DESC , 
				                     SERVICE_SDATE , 
				                     SERVICE_EDATE, 
				                     DEPT_CD ,
				                     REG_ID , 
				                     SMS_CNT , 
				                     FAX_CNT, 
				                     MAIL_CNT, 
				                     SVY_CNT, 
				                     UP_CNT, 
				                     MEDIA_DATE, 
				                     DEMAND_DATE, 
				                     BIGGERDATE, 
				                     STATUS, 
				                     EDATE 
				                FROM 
				                     (SELECT MAX (SEQ) SEQ, 
				                            TRADE_ID TRADE_ID, 
				                            MAX(SERVICE_NM) SERVICE_NM, 
				                            MAX(SERVICE_DESC) SERVICE_DESC, 
				                            MAX(SERVICE_SDATE) SERVICE_SDATE, 
				                            MAX(SERVICE_EDATE) SERVICE_EDATE, 
				                            MAX(DEPT_CD) DEPT_CD, 
				                            MAX(REG_ID) REG_ID, 
				                            SUM(SMS_CNT) SMS_CNT, 
				                            SUM(FAX_CNT) FAX_CNT, 
				                            SUM(MAIL_CNT) MAIL_CNT, 
				                            SUM(SVY_CNT) SVY_CNT, 
				                            SUM(UP_CNT) UP_CNT, 
				                            MAX(MEDIA_DATE) AS MEDIA_DATE, 
				                            MAX(DEMAND_DATE) AS DEMAND_DATE, 
				                            MAX(BIGGERDATE) AS BIGGERDATE, 
				                            MAX(STATUS) AS STATUS , 
				                            MAX(EDATE) EDATE 
				                       FROM 
				                            (SELECT MAX (A.SEQ) SEQ, 
				                                   A.TRADE_ID TRADE_ID, 
				                                   MAX(A.SERVICE_NM) SERVICE_NM, 
				                                   MAX(A.SERVICE_DESC) SERVICE_DESC, 
				                                   MAX(TO_CHAR (A.SERVICE_SDATE, 'YYYY-MM-DD')) SERVICE_SDATE, 
				                                   MAX(TO_CHAR (A.SERVICE_EDATE, 'YYYY-MM-DD')) SERVICE_EDATE, 
				                                   MAX (A.DEPT_CD) DEPT_CD, 
				                                   MAX (A.REG_ID)REG_ID, 
				                                   MAX(DECODE (B.MEDIA_CD, 'S', B.MEDIA_SEND, 0)) SMS_CNT, 
				                                   MAX(DECODE (B.MEDIA_CD, 'F', B.MEDIA_SEND, 0)) FAX_CNT, 
				                                   MAX(DECODE (B.MEDIA_CD, 'M', B.MEDIA_SEND, 0)) MAIL_CNT, 
				                                   MAX(DECODE (B.MEDIA_CD, 'R', B.MEDIA_SEND, 0)) SVY_CNT, 
				                                   MAX(A.UP_CNT) UP_CNT, 
				                                   TO_CHAR (MAX(B.MEDIA_DATE), 'YYYY-MM-DD') AS MEDIA_DATE, 
				                                   TO_CHAR (MAX(C.DEMAND_DATE), 'YYYY-MM-DD') AS DEMAND_DATE, 
				                                   CASE 
				                                       WHEN MAX(B.MEDIA_DATE) <![CDATA[>]]> MAX(C.DEMAND_DATE) 
				                                       THEN NVL(MAX(B.MEDIA_DATE),MAX(C.DEMAND_DATE)) 
				                                       ELSE NVL(MAX(C.DEMAND_DATE), MAX(B.MEDIA_DATE)) 
				                                   END AS BIGGERDATE, 
				                                   CASE 
				                                       WHEN 
				                                           CASE 
				                                               WHEN MAX(B.MEDIA_DATE) <![CDATA[>]]> MAX(C.DEMAND_DATE) 
				                                               THEN NVL(MAX(B.MEDIA_DATE),MAX(C.DEMAND_DATE)) 
				                                               ELSE NVL(MAX(C.DEMAND_DATE), MAX(B.MEDIA_DATE)) 
				                                           END >= (SYSDATE -30) 
				                                       THEN 'P' 
				                                       ELSE 'E' 
				                                   END AS STATUS , 
				                                   GREATEST( MAX (NVL (C.REG_DATE, NVL(C.START_DATE, A.REG_DATE ))), MAX ( NVL (B.MEDIA_DATE, A.REG_DATE) ) ) EDATE 
				                              FROM MARKETING_KEY A, 
				                                   MEDIA_LIST B, 
				                                   MARKETING_LOG C 
				                             WHERE A.TRADE_ID = B.SID(+) 
				                                   AND B.SID = C.SID(+) 
				                                   AND B.POOL_SEQ = C.POOL_SEQ(+) 
				                                   AND B.MEDIA_CD = C.MEDIA_CD (+) 
				                                   AND A.BIZ_SEQ = #{bizSeq} 
				                             GROUP BY A.TRADE_ID , 
				                                   B.POOL_SEQ 
				                            ) 
				                      GROUP BY TRADE_ID 
				                     ) AA 
				            ORDER BY AA.EDATE DESC 
				              ) BB 
				       ) CC
		</select>
		<!--마케팅실시 조회 End-->
		
		<!--사업참가자 현황, 사업수행(참가자 선별), 사업완료 조회 Start-->
		<select id="selectBusinessInfo"  parameterType="bsnsReqDataVO" resultType="egovMap">
			SELECT  /* Bsnsreqstinqire.selectBusinessInfo */
					   COUNT(PERSON_SEQ) TOT_CNT, /*신청자수*/ 
				       NVL(SUM(DECODE( DELETE_YN , 'Y',1,0)),0)DELETE_CNT, /*제외자수*/ 
				       NVL(SUM(DECODE( DELETE_YN , 'N',1,0)),0) PERSON_CNT, 
				       NVL(COUNT(DISTINCT DECODE( DELETE_YN , 'N',DECODE(CORP_SEQ,NULL,NULL,CORP_SEQ),NULL)),0) CORP_CNT, /*신청업체수*/ 
				       NVL(SUM(DECODE( ATTENDANCE_ORDER_NUM , NULL,0,1)),0) ATTENDANCE_ORDER_NUM_CNT, /*참가자수*/ 
				       NVL(COUNT(DISTINCT DECODE( ATTENDANCE_ORDER_NUM , NULL, NULL, DECODE(CORP_SEQ,NULL,NULL,CORP_SEQ))),0) ATTENDANCE_CORP_CNT, /*참가업체수*/ 
				       NVL(SUM(DECODE( DELETE_YN , 'N',DECODE(USER_FG,'5',1,0),0)),0) FG_5_CNT, 
				       NVL(SUM(DECODE( DELETE_YN , 'N',DECODE(USER_FG,'6',1,0),0)),0) FG_6_CNT, 
				       NVL(SUM(DECODE( DELETE_YN , 'N',DECODE(USER_FG,'7',1,0),0)),0) FG_7_CNT, 
				       NVL(SUM(DECODE( DELETE_YN , 'N',DECODE(USER_FG,'8',1,0),0)),0) FG_8_CNT, 
				       NVL(SUM(DECODE( DELETE_YN , 'N',DECODE(USER_FG,'9',1,0),0)),0) FG_9_CNT, 
				       NVL(COUNT(DISTINCT DECODE( DELETE_YN , 'N',DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'10',CORP_SEQ,NULL) ),NULL)),0) FG_10_CNT, 
				       NVL(COUNT(DISTINCT DECODE( DELETE_YN , 'N',DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'11',CORP_SEQ,NULL) ),NULL)),0) FG_11_CNT, 
				       NVL(COUNT(DISTINCT DECODE( DELETE_YN , 'N',DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'12',CORP_SEQ,NULL) ),NULL)),0) FG_12_CNT, 
				       NVL(COUNT(DISTINCT DECODE( DELETE_YN , 'N',DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'13',CORP_SEQ,NULL) ),NULL)),0) FG_13_CNT, 
				       NVL(COUNT(DISTINCT DECODE( DELETE_YN , 'N',DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'14',CORP_SEQ,NULL) ),NULL)),0) FG_14_CNT, 
				       NVL(COUNT(DISTINCT DECODE( DELETE_YN , 'N',DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'15',CORP_SEQ,NULL) ),NULL)),0) FG_15_CNT, 
				       NVL(COUNT(DISTINCT DECODE( DELETE_YN , 'N',DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'16',CORP_SEQ,NULL) ),NULL)),0) FG_16_CNT, 
				       NVL(COUNT(DISTINCT DECODE( DELETE_YN , 'N',DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'17',CORP_SEQ,NULL) ),NULL)),0) FG_17_CNT, 
				       NVL(COUNT(DISTINCT DECODE( DELETE_YN , 'N',DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'18',CORP_SEQ,NULL) ),NULL)),0) FG_18_CNT, 
				       NVL(COUNT(DISTINCT DECODE( DELETE_YN , 'N',DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'19',CORP_SEQ,NULL) ),NULL)),0) FG_19_CNT, 
				       NVL(COUNT(DISTINCT DECODE( DELETE_YN , 'N',DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'20',CORP_SEQ,NULL) ),NULL)),0) FG_20_CNT, 
				       NVL(COUNT(DISTINCT DECODE( DELETE_YN , 'N',DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'21',CORP_SEQ,NULL) ),NULL)),0) FG_21_CNT, 
				       NVL(SUM(DECODE(ATTENDANCE_ORDER_NUM , NULL,0,DECODE(USER_FG,'5',1,0))),0) AFG_5_CNT, 
				       NVL(SUM(DECODE(ATTENDANCE_ORDER_NUM , NULL,0,DECODE(USER_FG,'6',1,0))),0) AFG_6_CNT, 
				       NVL(SUM(DECODE(ATTENDANCE_ORDER_NUM , NULL,0,DECODE(USER_FG,'7',1,0))),0) AFG_7_CNT, 
				       NVL(SUM(DECODE(ATTENDANCE_ORDER_NUM , NULL,0,DECODE(USER_FG,'8',1,0))),0) AFG_8_CNT, 
				       NVL(SUM(DECODE(ATTENDANCE_ORDER_NUM , NULL,0,DECODE(USER_FG,'9',1,0))),0) AFG_9_CNT, 
				       NVL(COUNT(DISTINCT DECODE( ATTENDANCE_ORDER_NUM , NULL,NULL,DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'10',CORP_SEQ,NULL) ))),0) AFG_10_CNT, 
				       NVL(COUNT(DISTINCT DECODE( ATTENDANCE_ORDER_NUM , NULL,NULL,DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'11',CORP_SEQ,NULL) ))),0) AFG_11_CNT, 
				       NVL(COUNT(DISTINCT DECODE( ATTENDANCE_ORDER_NUM , NULL,NULL,DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'12',CORP_SEQ,NULL) ))),0) AFG_12_CNT, 
				       NVL(COUNT(DISTINCT DECODE( ATTENDANCE_ORDER_NUM , NULL,NULL,DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'13',CORP_SEQ,NULL) ))),0) AFG_13_CNT, 
				       NVL(COUNT(DISTINCT DECODE( ATTENDANCE_ORDER_NUM , NULL,NULL,DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'14',CORP_SEQ,NULL) ))),0) AFG_14_CNT, 
				       NVL(COUNT(DISTINCT DECODE( ATTENDANCE_ORDER_NUM , NULL,NULL,DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'15',CORP_SEQ,NULL) ))),0) AFG_15_CNT, 
				       NVL(COUNT(DISTINCT DECODE( ATTENDANCE_ORDER_NUM , NULL,NULL,DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'16',CORP_SEQ,NULL) ))),0) AFG_16_CNT, 
				       NVL(COUNT(DISTINCT DECODE( ATTENDANCE_ORDER_NUM , NULL,NULL,DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'17',CORP_SEQ,NULL) ))),0) AFG_17_CNT, 
				       NVL(COUNT(DISTINCT DECODE( ATTENDANCE_ORDER_NUM , NULL,NULL,DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'18',CORP_SEQ,NULL) ))),0) AFG_18_CNT, 
				       NVL(COUNT(DISTINCT DECODE( ATTENDANCE_ORDER_NUM , NULL,NULL,DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'19',CORP_SEQ,NULL) ))),0) AFG_19_CNT, 
				       NVL(COUNT(DISTINCT DECODE( ATTENDANCE_ORDER_NUM , NULL,NULL,DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'20',CORP_SEQ,NULL) ))),0) AFG_20_CNT, 
				       NVL(COUNT(DISTINCT DECODE( ATTENDANCE_ORDER_NUM , NULL,NULL,DECODE(CORP_SEQ,NULL,NULL,DECODE(CORP_USER_FG,'21',CORP_SEQ,NULL) ))),0) AFG_21_CNT 
				  FROM 
				       (SELECT 
				              /*+  INDEX(A BIZ_MST_PK) INDEX(B IDX_BIZAPPLICATION_BIZSEQ) INDEX(C IPERSON_MST_PK ) INDEX(D CORPORATE_MST_PK )  */ 
				              A.BIZ_SEQ, 
				              B.DELETE_YN, 
				              B.APP_SEQ, 
				              B.PERSON_SEQ, 
				              C.CORP_SEQ, 
				              C.USER_FG, 
				              D.USER_FG AS CORP_USER_FG, 
				              B.ATTENDANCE_ORDER_NUM 
				         FROM BIZ_MST A, 
				              BIZ_APPLICATION B, 
				              PERSON_MST C, 
				              CORPORATE_MST D 
				        WHERE A.BIZ_SEQ = B.BIZ_SEQ 
				              AND B.PERSON_SEQ = C.PERSON_SEQ 
				              AND C.CORP_SEQ = D.CORP_SEQ(+) 
				              AND A.BIZ_SEQ = #{bizSeq}
				       )  
		</select>
		<!--사업참가자 현황, 사업수행(참가자 선별), 사업완료 조회 End-->
		
		<!--만족도조사 실시 조회 Start-->
		<select id="selectSatisfactionInfo"  parameterType="bsnsReqDataVO" resultType="egovMap">
			SELECT  /* Bsnsreqstinqire.selectSatisfactionInfo */
			           SVY_ID, 
				       SVY_TITLE, 
				       SVY_FR_DT, 
				       SVY_TO_DT, 
				       REGST_NM, 
				       DEPT_NM, 
				       SVY_P_ID, 
				       USER_CNT, 
				       QUES_1, 
				       QUES_2, 
				       QUES_3, 
				       RNUM ,
				       CUST_CNT, 
				       QUES_1_S, 
				       QUES_2_S, 
				       QUES_3_S, 
				       QUES_4, 
				       QUES_5,
				       ANSWER_AMT, 
				       AMT, 
				       TRADE_ID 
				  FROM 
				       (SELECT SVY_ID, 
				              SVY_TITLE, 
				              SVY_FR_DT, 
				              SVY_TO_DT, 
				              REGST_NM, 
				              DEPT_NM, 
				              SVY_P_ID, 
				              USER_CNT, 
				              QUES_1, 
				              QUES_2, 
				              QUES_3, 
				              ROWNUM RNUM, 
				              CUST_CNT, 
				              QUES_1_S, 
				              QUES_2_S, 
				              QUES_3_S, 
				              QUES_4, 
				              QUES_5, 
				              ANSWER_AMT, 
				              ROUND(((QUES_1_S+QUES_2_S+QUES_3_S)/3),1) AMT, 
				              TRADE_ID 
				         FROM 
				              (SELECT SVY_ID, 
				                     SVY_TITLE, 
				                     SVY_FR_DT, 
				                     SVY_TO_DT, 
				                     REGST_NM, 
				                     DEPT_NM, 
				                     SVY_P_ID, 
				                     USER_CNT, 
				                     CUST_CNT , 
				                     QUES_1 , 
				                     QUES_2 , 
				                     QUES_3 , 
				                     ROUND((USER_CNT/CUST_CNT)*100,1) ANSWER_AMT , 
				                     ROUND(QUES_1_S/CNT, 1) QUES_1_S , 
				                     ROUND(QUES_2_S/CNT, 1) QUES_2_S , 
				                     ROUND(QUES_3_S/CNT, 1) QUES_3_S , 
				                     QUES_4, 
				                     QUES_5, 
				                     TRADE_ID 
				                FROM 
				                     (SELECT SVY_ID, 
				                            SVY_TITLE, 
				                            SVY_FR_DT, 
				                            SVY_TO_DT, 
				                            REGST_NM, 
				                            DEPT_NM, 
				                            SVY_P_ID , 
				                            SUM
				                            (
				                                CASE 
				                                    WHEN QUES_ID = 1 
				                                    THEN CNT * QUES_POINT 
				                                    ELSE 0 
				                                END
				                            ) 
				                            QUES_1 , 
				                            SUM
				                            (
				                                CASE 
				                                    WHEN QUES_ID = 2 
				                                    THEN CNT * QUES_POINT 
				                                    ELSE 0 
				                                END
				                            ) 
				                            QUES_2 , 
				                            SUM
				                            (
				                                CASE 
				                                    WHEN QUES_ID = 3 
				                                    THEN CNT * QUES_POINT 
				                                    ELSE 0 
				                                END
				                            ) 
				                            QUES_3 , 
				                            SUM
				                            (
				                                CASE 
				                                    WHEN QUES_ID = 1 
				                                    THEN EXP_POINT * CNT 
				                                    ELSE 0 
				                                END
				                            ) 
				                            QUES_1_S , 
				                            SUM
				                            (
				                                CASE 
				                                    WHEN QUES_ID = 2 
				                                    THEN EXP_POINT * CNT 
				                                    ELSE 0 
				                                END
				                            ) 
				                            QUES_2_S , 
				                            SUM
				                            (
				                                CASE 
				                                    WHEN QUES_ID = 3 
				                                    THEN EXP_POINT * CNT 
				                                    ELSE 0 
				                                END
				                            ) 
				                            QUES_3_S , 
				                            (SELECT COUNT(REPLY) 
				                              FROM FSA102T 
				                             WHERE SVY_ID = A.SVY_ID 
				                                   AND QUES_ID = '4' 
				                                   AND QUES_SEQ = 0
				                            ) QUES_4 , 
				                            (SELECT COUNT(REPLY) 
				                              FROM FSA102T 
				                             WHERE SVY_ID = A.SVY_ID 
				                                   AND QUES_ID = '5' 
				                                   AND QUES_SEQ = 0
				                            ) QUES_5 , 
				                            (SELECT COUNT(*) 
				                              FROM FSA101T 
				                             WHERE SVY_ID = A.SVY_ID 
				                                   AND END_DT IS NOT NULL 
				                            ) USER_CNT ,
				                            MAX(CUST_CNT) CUST_CNT, 
				                            TRADE_ID , 
				                            MAX(CNT) CNT 
				                       FROM 
				                            (SELECT SVY_ID, 
				                                   SVY_TITLE, 
				                                   SVY_FR_DT, 
				                                   SVY_TO_DT, 
				                                   REGST_NM, 
				                                   DEPT_NM, 
				                                   SVY_P_ID, 
				                                   QUES_ID, 
				                                   (SELECT QUES_POINT 
				                                     FROM FSP102T 
				                                    WHERE SVY_P_ID = A.SVY_P_ID 
				                                          AND QUES_ID = A.QUES_ID 
				                                   ) QUES_POINT , 
				                                   QUES_SEQ, 
				                                   REPLY, 
				                                   (SELECT EXP_POINT 
				                                     FROM FSP103T 
				                                    WHERE SVY_P_ID = A.SVY_P_ID 
				                                          AND QUES_ID = A.QUES_ID 
				                                          AND QUES_SEQ = A.QUES_SEQ 
				                                          AND EXP_ID = A.REPLY 
				                                   ) EXP_POINT , 
				                                   CNT ,
				                                   CUST_CNT, 
				                                   TRADE_ID 
				                              FROM 
				                                   (SELECT A.SVY_ID, 
				                                          SVY_TITLE, 
				                                          SVY_FR_DT, 
				                                          SVY_TO_DT, 
				                                          REGST_NM, 
				                                          NVL(DEPT_NM, MIN
				                                          (
				                                                 (SELECT DEPT_NAME 
				                                                   FROM KAMIS.INS9012@GW 
				                                                  WHERE DEPT_CODE = A.DEPT_ID 
				                                                 )
				                                             )
				                                             ) DEPT_NM, 
				                                             A.SVY_P_ID, 
				                                             C.QUES_ID, 
				                                             C.QUES_SEQ, 
				                                             REPLY, 
				                                             COUNT(*) CNT, 
				                                             MAX(CUST_CNT) CUST_CNT, 
				                                             TRADE_ID 
				                                        FROM FSM101T A, 
				                                             FSA101T B, 
				                                             FSA102T C, 
				                                             FSP102T D 
				                                       WHERE A.SVY_ID = B.SVY_ID 
				                                             AND A.SVY_ID=C.SVY_ID 
				                                             AND A.SVY_P_ID = D.SVY_P_ID 
				                                             AND B.CUST_ID = C.CUST_ID 
				                                             AND B.SEQ = C.SEQ 
				                                             AND C.QUES_ID = D.QUES_ID 
				                                             AND A.SVY_TP = '001' 
				                                             AND A.SVY_STATUS IN ('002', '003') 
				                                             AND D.QUES_TP = '006' 
				                                             AND B.END_DT IS NOT NULL 
				                                             AND A.TRADE_ID = #{bizSeq}
				                                             /*BIZ_SEQ*/ 
				                                       GROUP BY A.SVY_ID, 
				                                             SVY_TITLE, 
				                                             SVY_FR_DT, 
				                                             SVY_TO_DT, 
				                                             REGST_NM, 
				                                             DEPT_NM, 
				                                             A.SVY_P_ID, 
				                                             C.QUES_ID, 
				                                             C.QUES_SEQ, 
				                                             REPLY, 
				                                             TRADE_ID 
				                                      ) A 
				                               ) A 
				                         GROUP BY SVY_ID, 
				                               SVY_TITLE, 
				                               SVY_FR_DT, 
				                               SVY_TO_DT, 
				                               REGST_NM, 
				                               DEPT_NM, 
				                               SVY_P_ID, 
				                               TRADE_ID 
				                        ) 
				               ORDER BY SVY_ID DESC 
				                 ) 
				          )
		</select>
		<!--만족도조사 실시 조회 End-->
	
	<!--##################################사업상태 모니터링 팝업 End##################################-->
	
	
	
	
	
	
	
	<!--##################################신청자 등록(엑셀,웹) start##################################-->
	<!-- 법인고객중복체크 -->
	<select id="selectDuplCorp" parameterType="bsnsBasicInfoVO" resultType="int">
		SELECT /* Bsnsreqstinqire.selectDuplCorp */
			F_DUPLICATE_CORP(#{userId}, #{compNoErms}, #{corpKorNm}, #{mainTelNo}, #{ceoNm}) CORP_SEQ
		 FROM DUAL
	</select>

                      
	<!-- 고객번호 발급 -->
	<select id="selectPersonCorpSEQ" parameterType="bsnsBasicInfoVO" resultType="int">
			SELECT /* Bsnsreqstinqire.selectPersonCorpSEQ */
				CUSTOMER_INFO_SEQ.NEXTVAL AS SEQ
			 FROM DUAL
	</select>
                      
	<!-- 법인고객 등록 -->
	<insert id="insertCorpCustomer" parameterType="bsnsBasicInfoVO">
			INSERT /* Bsnsreqstinqire.insertCorpCustomer */
				INTO CORPORATE_MST  
					( 
			           CORP_SEQ, 
			           COMP_NO, 
			           CORP_KOR_NM, 
			           CEO_KOR_NM , 
			           DELETE_YN, 
			           SYSTEM_TP_CD, 
			           CREATE_DATE, 
			           CREATE_ID, 
			           UPDATE_DATE, 
			           UPDATE_ID,
			           USER_FG, 
			           MAIN_TEL_NO, 
			           MAIN_TEL_NO_ERMS,
			           B_TEL_NO_ERMS , 
			           MAIN_FAX_NO, 
			           MAIN_FAX_NO_ERMS , 
			           INDUSTRY_CD, 
			           JONGMOK_CD, 
			           HOMEPAGE, 
			           FOUND_YYYYMMDD, 
			           EMP_CNT, 
			           SALES, 
			           EXPORT_SALES, 
			           IMPORT_SALES , 
			           COMPANY_DESC, 
			           ITEM_KOR_NM
			       ) 
			       VALUES 
			       ( 
			           #{corpSeq} , 
			           #{compNoErms} , 
			           #{corpKorNm} , 
			           #{ceoNm} ,
			           'N' , 
			           '014' , 
			           SYSDATE , 
			           #{userId} , 
			           SYSDATE , 
			           #{userId} ,
			           '17' , 
			           #{mainTelNo} , 
			           #{mainTelNoErms} , 
			           #{bTelNoErms} , 
			           #{mainFaxNo} , 
			           #{mainFaxNoErms} , 
			           #{industryCd} , 
			           #{jongmokCd} , 
			           #{homepage} , 
			           #{foundYyyymmdd} , 
			           #{empCnt} , 
			           #{sales} , 
			           #{exportSales} , 
			           #{importSales} , 
			           #{companyDesc} , 
			           #{itemKorNm} 
			       )  
	</insert>
                      
	<!-- 법인고객 업데이트 -->
    <update id="updateCorpCustomer" parameterType="bsnsBasicInfoVO">
			UPDATE /* Bsnsreqstinqire.updateCorpCustomer */
			CORPORATE_MST 
		       SET COMP_NO = nvl(#{compNoErms} , COMP_NO) , 
		       <if test='compNoErms == null or compNoErms ==""' >
		       		CORP_KOR_NM = #{corpKorNm} , 
		       </if>
		       CEO_KOR_NM = 
		       ( 
		           CASE 
		               WHEN CEO_UPDATE_YN = 'Y' 
		               THEN #{ceoNm} 
		               ELSE CEO_KOR_NM 
		           END 
		       ) 
		       , 
		       UPDATE_DATE = SYSDATE , 
		       UPDATE_ID = #{userId}
		       <if test='industryCd != null and industryCd != ""'>
		       		  ,INDUSTRY_CD = #{industryCd} 
		       </if>
		       <if test='jongmokCd != null and jongmokCd != ""'>
		       		 ,JONGMOK_CD = #{jongmokCd} 
		       </if>
		       <if test='homepage != null and homepage != ""'>
		       		 ,HOMEPAGE = #{homepage}
		       </if>
		       <if test='foundYyyymmdd != null and foundYyyymmdd != ""'> 
		       		 ,FOUND_YYYYMMDD = #{foundYyyymmdd} 
		       </if>
		       <if test='empCnt != null and empCnt != ""'>
		       		 ,EMP_CNT = #{empCnt} 
		       </if>
		       <if test='sales != null and sales != ""'>
		       		 ,SALES = #{sales} 
		       </if>
		       <if test='exportSales != null and exportSales != ""'>
		       		 ,EXPORT_SALES = #{exportSales} 
		       </if>
		       <if test='importSales != null and importSales != ""'>
		       		 ,IMPORT_SALES = #{importSales} , 
		       </if>
		       <if test='companyDesc != null and companyDesc != ""'>
		       		 ,COMPANY_DESC = #{companyDesc} 
		       </if>
		       <if test='itemKorNm != null and itemKorNm != ""'>
		       		 ,ITEM_KOR_NM = #{itemKorNm} 
		       </if>
		       <if test='mainTelNo != null and mainTelNo != ""'>
		       		 ,MAIN_TEL_NO = #{mainTelNo}x
		       </if>
		       <if test='mainTelNoErms != null and mainTelNoErms != ""'> 
		        ,MAIN_TEL_NO_ERMS = #{mainTelNoErms}
		       </if>
		       <if test='bTelNoErms != null and bTelNoErms != ""'> 
		       		 ,B_TEL_NO_ERMS = #{bTelNoErms}
		       </if>
		 WHERE CORP_SEQ = #{corpSeq}
	</update>
	                  
	<!-- 전화번호,이메일로 고객 중복 체크 -->
    <select id="selectDuplPerson" parameterType="bsnsBasicInfoVO" resultType="int">
			SELECT /* Bsnsreqstinqire.selectDuplPerson */
			F_DUPLICATE_PERSON(#{appNm}, #{cellNo}, #{email}, #{telNo}) PERSON_SEQ
		 FROM DUAL
	</select>
	
	<!-- 이름, 생년월일로 고객 중복 체크 -->
    <select id="selectDuplPerson2" parameterType="bsnsBasicInfoVO" resultType="int">
			SELECT /* Bsnsreqstinqire.selectDuplPerson2 */
			FGETPERSONSEQ(#{corpSeq}, #{appNm}, #{personResiNo}) PERSON_SEQ
		 FROM DUAL
	</select>
	                  
	<!-- 개인고객등록 -->
    <insert id="insertPersonCustomer" parameterType="bsnsBasicInfoVO">
			INSERT /* Bsnsreqstinqire.insertPersonCustomer */
			  INTO PERSON_MST  
		       ( 
		           PERSON_SEQ
		           , CORP_SEQ
		           , PERSON_NM 
		           , CELL_NO
		           , PERSON_EMAIL 
		           , DELETE_YN
		           , SYSTEM_TP_CD 
		           , CREATE_DATE
		           , CREATE_ID
		           , UPDATE_DATE 
		           , UPDATE_ID
		           , USER_ID
		           , USER_FG 
		           , CELL_NO_ERMS
		           , FAX_NO
		           , FAX_NO_ERMS 
		           , BIRTH_YYMMDD 
		           , DUTY_NM
		           , DEPT_NM 
		           , CORP_NM 
		           , TEL_NO
		           , TEL_NO_ERMS 
		       ) 
		       VALUES 
		       ( 
		           #{personSeq}
		           , #{corpSeq}
		           , #{appNm}
		           , #{cellNo}
		           , #{email}
		           , 'N'
		           , '014'
		           , SYSDATE
		           , #{userId}
		           , SYSDATE
		           , #{userId}
		           , (SELECT member_id 
		              FROM kobz_member_t@member 
		             WHERE member_id = #{userId} 
		                   AND member_nm = #{appNm})  
		           , '7'
		           , #{cellNoErms}
		           , #{faxNo}
		           , #{faxNoErms}
		           , #{personResiNo}
		           , #{pozNm}
		           , #{dept}
		           , #{corpNm}
		           , #{corpTel}
		           , #{corpTelErms} 
		       )   
	</insert>
	                  
	<!-- 개인고객업데이트 -->
    <update id="updatePersonCustomer" parameterType="bsnsBasicInfoVO">
			UPDATE /* Bsnsreqstinqire.updatePersonCustomer */
			PERSON_MST
				SET 
					 , CELL_NO 			    = DECODE(FN_CELL_NO(#{cellNo}),NULL,TEL_NO,FN_CELL_NO(#{cellNo}))
					 , CELL_NO_ERMS 	    = #{cellNoErms}
					 <if test='faxNo != null and faxNo != ""'>
					 	, FAX_NO 		    = DECODE(FN_FAX_NO(#{faxNo}),NULL,FAX_NO,FN_FAX_NO(#{faxNo}))
					 </if>
					 <if test='faxNoErms != null and faxNoErms != ""'>
					 	, FAX_NO_ERMS    = #{faxNoErms}
					 </if>
					 <if test='email != null and email != ""'>
					 	, PERSON_EMAIL   = DECODE(FN_MAIL(#{email}),NULL,PERSON_EMAIL,FN_MAIL(#{email}))
					 </if>
					 <if test='corpSeq != null and corpSeq != ""'>
					 	, CORP_SEQ 	       = #{corpSeq}
					 </if>
					 <if test='personResiNo != null and personResiNo != ""'>
					 	, BIRTH_YYMMDD  = #{personResiNo}
					 </if>
					 <if test='pozNm != null and pozNm != ""'>
					 	, DUTY_NM 		   = #{pozNm}
					 </if>
					 <if test='dept != null and dept != ""'>
					 	, DEPT_NM 		   = #{dept}
					 </if>
					 <if test='compNo == null or compNo == ""'>
					 	<if test='corpKorNm != null and corpKorNm != ""'>
					 		, CORP_NM 	   = #{corpKorNm}
					 	</if>
					 </if>
					 <if test='corpTel != null and corpTel != ""'>
					 	, TEL_NO 			   = DECODE(FN_TEL_NO(#{corpTel}),NULL,TEL_NO,FN_TEL_NO(#{corpTel}))
					 </if>
					 <if test='corpTelErms != null and corpTelErms != ""'>
					 	, TEL_NO_ERMS    = #{corpTelErms}
					 </if>
					 , UPDATE_DATE 	   = SYSDATE
					 , UPDATE_ID 		   = #{userId}
		   WHERE PERSON_SEQ 		   = #{personSeq}
	</update>
	                  
	<!-- 사업신청테이블 조회(중복 등록 체크) -->
    <select id="selectDuplBizApp" parameterType="bsnsBasicInfoVO" resultType="int">
			SELECT /* Bsnsreqstinqire.selectDuplBizApp */
				COUNT(*) CNT
			 FROM BIZ_APPLICATION
			WHERE BIZ_SEQ = #{bizSeq}
			   AND PERSON_SEQ = #{personSeq}
	</select>
	                  
	<!-- 사업신청서(기본형) 등록 -->
	<insert id="insertBasicApp" parameterType="bsnsBasicInfoVO">
			INSERT /* Bsnsreqstinqire.insertBasicApp */
			  INTO BIZ_APPLICATION
			    ( 
				      APP_SEQ                       
					, BIZ_SEQ                       
					, PERSON_SEQ                    
					, COMP_NO                       
					, CORP_KOR_NM                   
					, CORP_ENG_NM                   
					, CEO_NM                        
					, APP_NM                        
					, PERSON_RESI_NO                
					, CELL_NO                       
					, EMAIL                         
					, CORP_TEL                      
					, FAX                           
					, HOMEPAGE                      
					, CORP_ADDRESS                  
					, CORP_TYPE                     
					, EMP_CNT                       
					, SALES                         
					, CONSULT_AREA                  
					, UPJONG                        
					, SOURCE                        
					, DELETE_YN                     
					, CREATE_DATE                   
					, CREATE_ID                     
					, UPDATE_DATE                   
					, UPDATE_ID                     
					, PROD_NM                       
					, MTYPE                         
					, POZ_NM                        
					, FILE_NAME1                    
					, FILE_PATH1                    
					, FILE_NAME2                    
					, FILE_PATH2                    
					, FILE_NAME3                    
					, FILE_PATH3                    
					, FILE_NAME4                    
					, FILE_PATH4                    
					, FILE_NAME5                    
					, FILE_PATH5                    
					, DEPT                    		
					, MEMBER_ID                    	
				) 
					VALUES 
				(                      
					  BIZ_APPLICATION_SEQ.nextval   
					, #{bizSeq}                             
					, #{personSeq}                             
					, #{compNo}                             
					, #{corpKorNm}                             
					, #{corpEngNm}                             
					, #{ceoNm}                             
					, #{appNm}                             
					, #{personResiNo}                             
					, #{cellNo}                             
					, #{email}                             
					, #{corpTel}                             
					, #{faxNo}                             
					, #{homepage}                             
					, #{corpAddress}                             
					, #{corpType}                             
					, #{empCnt}                             
					, #{sales}                             
					, #{consultArea}                             
					, #{upjong}                             
					, #{source}                             
					, 'N'                           
					, SYSDATE                       
					, #{userId}                             
					, SYSDATE                       
					, #{userId}                             
					, #{prodNm}                             
					, #{mtype}                             
					, #{pozNm}                             
					, #{fileName1}                             
					, #{filePath1}                             
					, #{fileName2}                             
					, #{filePath2}                             
					, #{fileName3}                             
					, #{filePath3}                             
					, #{fileName4}                             
					, #{filePath4}                             
					, #{fileName5}                             
					, #{filePath5}                             
					, #{dept}                             
					, #{userId}                             
				)                               
	</insert>
	
<!-- 고객관리파트의 개발이 완료된후 해당 메소드를 호출한다. insertPersonContact
	<insert id="insertPersonContact" parameterType="bsnsBasicInfoVO">
			INSERT /* Bsnsreqstinqire.insertPersonContact */
			  INTO 
	</insert> -->
	
	<!-- Kita.net 개인정보 수정 -->
	<update id="updateKitaInfo" parameterType="bsnsBasicInfoVO">
			UPDATE /* Bsnsreqstinqire.updateKitaInfo */
			<if test='osName == "0"'>
					kobz_member_t
			</if>
			<if test='osName == "1"'>
					kobz_member_t@member
			</if>
			SET
				HAND_TEL = #{cellNo}
			<if test='compNo != null and compNo != ""'>
					, SAUPJA_NO = #{compNo}
			</if>
			<if test='compNo == null or compNo == ""'>
				<if test='corpKorNm != null and corpKorNm != ""'>
					, CORP_NM = #{corpKorNm} 
				</if>
			</if>
			<if test='compNo != null and compNo != ""'>
					, CORP_NM = (select corp_kor_nm from corporate_mst where corp_seq = #{corpSeq})
			</if>
			<if test='corpTel != null and corpTel != ""'>
					, CORP_TEL = #{corpTel}  
			</if>
			<if test='faxNo != null and faxNo != ""'>
					, CORP_FAX = #{faxNo}  
			</if>
			<if test='email != null and email != ""'>
					, EMAIL_ADDR = #{email}
			</if>
			WHERE MEMBER_ID =   #{userId}   AND MEMBER_NM = #{appNm} 
	</update>
	
	
	
	<sql id="insertCrmMmsMsg">
			INSERT /* Bsnsreqstinqire.insertCrmMmsMsg */
			  INTO CRM_MMS_MSG
			  ( 
			  	 MSGKEY,                            
				 SUBJECT,                            
				 PHONE,                              
				 CALLBACK,                           
				 STATUS,                             
				 REQDATE,                            
				 MSG,                                
				 EXPIRETIME,                         
				 TYPE,                               
				 ID,                                 
				 ETC1,                               
				 ETC2,                               
				 ETC3,                               
				 ETC4                                
			 )                                    
				VALUES 
			(
			    MMS_MSG_SEQ.NEXTVAL           
			    , #{subject}
				<choose>
					<when test='"BIZ" == contactFlag'>
						<choose>
							<when test='"0" == insertOrder'>
								, #{cellNo1}
							</when>
							<when test='"1" == insertOrder'>
								, #{cellNo2}
							</when>
							<when test='"2" == insertOrder'>
								, #{cellNo3}
							</when>
						</choose>
					</when>
					<otherwise>
			    			, #{cellNo}                          
					</otherwise>
				</choose>        						
			    , '1566-5114'                 
			    , '0'                         
			    , SYSDATE                     
			    , #{msg}                         
			    , '43200'                     
			    , '0'                         
			    , #{userId}                           
			    , #{bizSeq}                  
			    , ''                          
			    , ''                          
			    , ''                          
			);                                   
                                     
	</sql>

	<sql id="insertRtmsRecipientInfo">
			INSERT /* Bsnsreqstinqire.insertRtmsRecipientInfo */
			  INTO RTMS_RECIPIENTINFO@CRMMAIL
			  ( 
		           MID, 
		           SUBID, 
		           TID, 
		           RID, 
		           RNAME, 
		           RMAIL 
		       ) 
		       VALUES 
		       ( 
		             #{mid} 
		           , 0 
		           , 0 
		           , #{rid}
		           <choose>
					<when test='"BIZ" == contactFlag'>
						<choose>
							<when test='"0" == insertOrder'>
								, #{korNm1} 
			           			, #{email1}
							</when>
							<when test='"1" == insertOrder'>
								, #{korNm}2}
			           			, #{email2}
							</when>
							<when test='"2" == insertOrder'>
								, #{korNm3}			           			
								, #{email3}
							</when>
						</choose>
					</when>
					<otherwise>
			           , #{korNm} 
			           , #{email} 
					</otherwise>
				</choose>
		       );                 
			  
	</sql>
	
	<sql id="insertRtmsMailQueue">
			INSERT /* Bsnsreqstinqire.insertRtmsMailQueue */
			  INTO RTMS_MAILQUEUE@CRMMAIL
			  (
		           MID, 
		           SUBID, 
		           TID, 
		           SID, 
		           SNAME, 
		           SMAIL, 
		           RPOS, 
		           CTNPOS, 
		           SUBJECT, 
		           CONTENTS, 
		           ISSECURE, 
		           SECURETEMPLATE
		       ) 
		       VALUES 
		       (
		            #{mid} 
		           , 0 
		           , 0 
		           , #{userId} 
		            <choose>
					<when test='"BIZ" == contactFlag'>
						<choose>
							<when test='"0" == insertOrder'>
								, #{korNm1} 
			           			, #{email1}
							</when>
							<when test='"1" == insertOrder'>
								, #{korNm}2}
			           			, #{email2}
							</when>
							<when test='"2" == insertOrder'>
								, #{korNm3}			           			
								, #{email3}
							</when>
						</choose>
					</when>
					<otherwise>
			           , #{korNm} 
			           , #{email} 
					</otherwise>
				</choose> 
		           , '0' 
		           , '0' 
		           , #{subject} 
		           , #{msg} 
		           , '0' 
		           , ''
		       );                             
	</sql>
	
	<sql id="insertCrmScTran">
			INSERT /* Bsnsreqstinqire.insertCrmScTran */
			  INTO CRM_SC_TRAN
			  (
			  		 TR_NUM                
					, TR_SENDDATE             
					, TR_ID          
					, TR_SENDSTAT             
					, TR_RSLTSTAT             
					, TR_MSGTYPE              
					, TR_PHONE               
					, TR_CALLBACK             
					, TR_RSLTDATE             
					, TR_MODIFIED             
					, TR_MSG             
					, TR_NET                  
					, TR_ETC1                 
					, TR_ETC2                  
					, TR_ETC3                  
					, TR_ETC4                  
					, TR_ETC5                 
					, TR_ETC6                  
					, TR_REALSENDDAT           
				)                          
				VALUES 
				(
			       SC_SEQUENCE.NEXTVAL 
			       <choose>
						<when test='"trSenddate != null and trSenddate != ""'>
							TO_DATE(#{trSenddate], 'YYYY-MM-DD HH24:MI')
				       </when>
				       <otherwise>
					       , SYSDATE
				       </otherwise>
				   </choose>
			       , ''
			       , '0'               
			       , '00'              
			       , '0'               
			       <choose>
					<when test='"BIZ" == contactFlag'>
						<choose>
							<when test='"0" == insertOrder'>
								, #{cellNo1}
							</when>
							<when test='"1" == insertOrder'>
								, #{cellNo2}
							</when>
							<when test='"2" == insertOrder'>
								, #{cellNo3}
							</when>
						</choose>
					</when>
					<otherwise>
			    			, #{cellNo}                          
					</otherwise>
				</choose>
				<choose>
					<when test='"trSenddate != null and trSenddate != ""'>
					, ''
			       </when>
			       <otherwise>
			       , '1566-5114'       
			       </otherwise> 
			    </choose>             
			       , ''                
			       , SYSDATE           
			       , #{msg}                
			       , ''                
			       , ''                
			       , ''                
			       , ''                
			       , ''                
			       , ''                
			       , ''                
			       , SYSDATE
			     );         
	</sql>
	
	<!-- 이메일 발송 테이블 저장 -->
	<insert id="insertMmsSendForOnlineBiz" parameterType="bsnsBasicInfoVO">
			{CALL /* Bsnsreqstinqire.insertMmsSendForOnlineBiz */
					DECLARE
					BEGIN
						
						<include refid="insertCrmMmsMsg"/>
						<include refid="insertRtmsRecipientInfo"/>
						<include refid="insertRtmsMailQueue"/>
						
					END
			}
	</insert>
	
	<!-- SMS 발송 테이블 저장 -->
	<insert id="insertSmsSendForOnlineBiz" parameterType="bsnsBasicInfoVO">
			{CALL /* Bsnsreqstinqire.insertSmsSendForOnlineBiz */
					DECLARE 
					BEGIN
						
						<include refid="insertCrmScTran"/>
						<include refid="insertRtmsRecipientInfo"/>
						<include refid="insertRtmsMailQueue"/>
						
					END
			}	
	
	</insert>
	
	<!-- 예약문자 발송 등록 -->
	<insert id="insertSmsReservedSendForOnlineBiz" parameterType="bsnsBasicInfoVO">
			/* Bsnsreqstinqire.insertSmsReservedSendForOnlineBiz */
			<include refid="insertCrmScTran"/>
	</insert>
	
	<!--##################################신청자 등록(엑셀,웹) end##################################-->
	
	
	<!--##################################사업완료 및 업로드 엑셀 내 신청자를 참가자로 변경 (엑셀,웹) start##################################-->
	
	<!-- 참가자 조회 -->
	<select id="selectBizAttendanceComplete" parameterType="bsnsBasicInfoVO" resultType="bsnsBasicInfoVO">
	    SELECT /* Bsnsreqstinqire.selectBizAttendanceComplete */
					BA.BIZ_SEQ	            AS BIZ_SEQ,       
					BA.APP_SEQ				AS APP_SEQ,		
					BA.PERSON_SEQ			AS PERSON_SEQ,	
					BA.APP_NM				AS APP_NM,		
					BA.CELL_NO				AS CELL_NO,		
					BA.EMAIL					AS EMAIL,		
					BACS.APP_SEQ			AS APP_SEQ1,	
					BACS.PERSON_SEQ1	AS PERSON_SEQ1,	
					BACS.KOR_NM1			AS APP_NM1,		
					BACS.CELL1				AS CELL_NO1,	
					BACS.EMAIL1			AS EMAIL1,		
					BA.ATTENDANCE_ORDER_NUM	       
				FROM	                           
					BIZ_MST	BM,	                   
					BIZ_APPLICATION	BA,	           
					BIZ_APP_CONSULT_SUB BACS	   
				WHERE	                           
					BA.BIZ_SEQ = #{bizSeq}	   
					AND BA.BIZ_SEQ = BM.BIZ_SEQ		
					AND BA.APP_SEQ = BACS.APP_SEQ(+)
			/*
			 * 엑셀 내 신청자의 모든 정보로 조회에서 엑셀내용과 DB에 저장된 내용이 다를 경우(담당자가 엑셀 내 항목 지울 경우) 참가자로 처리가 안될 수 있음
			 * 1. 사업자등록번호 + 신청자명 + 휴대폰번호
			 * 2. 사업자등록번호 + 신청자명 + 이메일
			 * 3. 회사명 + 대표자 + 신청자명 + 휴대폰번호
			 * 4. 회사명 + 대표자 + 신청자명 + 이메일
			 */
				<if test='compNo != null and compNo != ""'>
					AND REPLACE(BA.COMP_NO, '-', '') = REPLACE(#{compNo}, '-', '')
				</if>
				<if test='compNo == null and compNo == ""'>
					<if test='corpKorNm != null and corpKorNm != ""'>
						AND BA.CORP_KOR_NM = #{corpKorNm}
					</if>
					<if test='searchType == "1"'>
						<if test='ceoNm != null and ceoNm != ""'>
							AND BA.CEO_NM = #{ceoNm}
						</if>
					</if>
				</if>
				<if test='appNm != null and appNm != ""'>
					AND ( BA.APP_NM = #{appNm} OR BACS.KOR_NM1 = #{appNm} )
				</if>
				<if test='searchType == "1"'>
					<if test='cellNo != null and cellNo != ""'>
						AND ( 
							REPLACE(BA.CELL_NO, '-', '') = REPLACE(#{cellNo}, '-', '')
							OR   REPLACE(BACS.CELL1, '-', '') = REPLACE(#{cellNo}, '-', '') 
							)
					</if>
					<if test='cellNo == null and cellNo == ""'>
						<if test='email != null and email != ""'>
							AND ( BA.EMAIL = #{email} OR BACS.EMAIL1 = #{email} )
						</if>
					</if>
				</if>
	</select>

	<!-- 참석여부 확인 조회 -->
	<select id="selectAttendanceYn" parameterType="bsnsBasicInfoVO" resultType="bsnsBasicInfoVO">
	    SELECT /* Bsnsreqstinqire.selectAttendanceYn */
                  ATTENDANCE_ORDER_NUM 
         FROM BIZ_APPLICATION
 		WHERE ATTENDANCE_ORDER_NUM IS NOT NULL
   		   AND BIZ_SEQ = #{bizSeq}
   		   <!-- <choose>
	   		   	<when test='gubun == "1"'> -->
	   		   	/*기본형*/
	   		   		AND PERSON_SEQ = #{attendancePersonSeq}  
	   		   	<!-- </when>
	   		   	<when test='gubun == "2"'>
	   		   	/*맞춤형*/
	   		   		 AND APP_SEQ = #{attendancePersonSeq}
	   		   	</when> 
   		   </choose> -->
	</select>

	<!-- 참석여부 확인 업데이트 -->
	<update id="updateAttendanceYn" parameterType="bsnsBasicInfoVO">
			UPDATE /* Bsnsreqstinqire.updateAttendanceYn */
			BIZ_APPLICATION
				 SET ATTENDANCE_ORDER_NUM = 
				 (SELECT MAX(TO_NUMBER(NVL(ATTENDANCE_ORDER_NUM, 0))) + 1 FROM BIZ_APPLICATION WHERE BIZ_SEQ = #{bizSeq})
				 <!-- <choose>
		   		   	<when test='gubun == "1"'> -->
		   		   	/*기본형*/
		   		   		WHERE PERSON_SEQ = #{attendancePersonSeq}  
	   		   		 	AND BIZ_SEQ = #{bizSeq}
		   		   	<!-- </when>
					 <when test='gubun == "2"'>
		   		   	/*맞춤형*/
		   		   		 AND APP_SEQ = #{attendancePersonSeq}
		   		   	</when> 
   		   		</choose> -->
	</update>

	<!-- 맞춤형 참석여부 확인 -->
	<!-- <select id="selectAttendanceYn2" parameterType="bsnsBasicInfoVO" resultType="bsnsBasicInfoVO">
		    SELECT /* Bsnsreqstinqire.selectAttendanceYn2 */
		    		 ATTENDANCE_ORDER_NUM 
         	 FROM BIZ_APPLICATION
 		   WHERE APP_SEQ = #{attendancePersonSeq}                      
   		      AND BIZ_SEQ = #{bizSeq}
   		      AND ATTENDANCE_ORDER_NUM IS NOT NULL
	</select> -->
	
<!-- updateAttendanceYn2
	<update id="updateAttendanceYn2" parameterType="bsnsBasicInfoVO">
			UPDATE /* Bsnsreqstinqire.updateAttendanceYn2 */
			BIZ_MST
				SET
	</update> -->
	
	
	 <!-- 엑셀 파일 내 참석자 모두 저장 후 사업완료로 표시 -->
	<update id="updateBizCompleteYn" parameterType="String">
			UPDATE /* Bsnsreqstinqire.updateBizCompleteYn */
			BIZ_MST
				SET COMPLETE_YN = 'Y'
				WHERE BIZ_SEQ 	= #{bizSeq}
	</update>
	
	<!--##################################사업완료 및 업로드 엑셀 내 신청자를 참가자로 변경 (엑셀,웹) end##################################-->
	
	
	
	<!--##################################사업신청상세 start##################################-->
	<!--사업신청상세 조회-->
	<select id="selectBsnsreqstinqireDetail" parameterType="bsnsReqDataVO" resultType="dkMap">
		SELECT  /* Bsnsreqstinqire.selectBsnsreqstinqireDetail */                                                                                                                                                                                     
			        BIZ_SEQ                                                                                                                                                                               
			       ,BIZ_TITLE                                                                                                                                                                             
			       ,TO_CHAR(BIZ_SDATE,'YYYY-MM-DD') AS BIZ_SDATE                                                                                                                                          
			       ,TO_CHAR(BIZ_EDATE,'YYYY-MM-DD') AS BIZ_EDATE                                                                                                                                          
			       ,TO_CHAR(BIZ_JOIN_SDATE,'YYYY-MM-DD') AS BIZ_JOIN_SDATE                                                                                                                               
			       ,TO_CHAR(BIZ_JOIN_EDATE,'YYYY-MM-DD') AS BIZ_JOIN_EDATE
			       ,BIZ_TIME                                                                                                                                                                              
			       ,BIZ_PLACE                                                                                                                                                                             
			       ,COMP_NO_YN                                                                                                                                                                            
			       ,BIZ_TARGET                                                                                                                                                                            
			       ,BIZ_CONTENT                                                                                                                                                                           
			       ,TEMPLATE_GB                                                                                                                                                                           
			       ,TEMPLATE_PATH                                                                                                                                                                         
			       ,REPORT_CONTENT                                                                                                                                                                        
			       ,MOBILE_YN                                                                                                                                                                             
			       ,COMP_NO_YN                                                                                                                                                                            
			       ,DELETE_YN                                                                                                                                                                             
			       ,CREATE_DATE                                                                                                                                                                           
			       ,CREATE_ID                                                                                                                                                                            
			       ,UPDATE_DATE                                                                                                                                                                           
			       ,UPDATE_ID                                                                                                                                                                            
			       ,MTYPE_YN                                                                                                                                                                              
			       ,MTYPE_U_YN                                                                                                                                                                            
			       ,NVL(KOR_FILE_YN,'N') KOR_FILE_YN                                                                                                                                                     
			       ,NVL(ENG_FILE_YN,'N') ENG_FILE_YN	                                                                                                                                                  
			       ,FILE_NAME1                                                                                                                                                       
			       ,FILE_TEMP_NAME1                                                                                                                                                                      
			       ,FILE_PATH1                                                                                                                                                                        
			       ,FILE_NAME2	                                                                                                                                                                          
			       ,FILE_TEMP_NAME2	                                                                                                                                                                      
			       ,FILE_PATH2                                                                                                                                                                        
			       ,FILE_NAME3	                                                                                                                                                                          
			       ,FILE_TEMP_NAME3                                                                                                                                                                       
			       ,FILE_PATH3                                                                                                                                                                            
			       ,FILE_NAME4	                                                                                                                                                                          
			       ,FILE_TEMP_NAME4	                                                                                                                                                                      
			       ,FILE_PATH4	                                                                                                                                                                          
			       ,FILE_NAME5	                                                                                                                                                                          
			       ,FILE_TEMP_NAME5                                                                                                                                                                       
			       ,FILE_PATH5                                                                                                                                                                            
			       ,DEPT_CD                	                                                                                                                                                              
			       ,TEMP_YN                                                                                                                            
			       ,NON_TARGET                                                                                                                      
			       ,END_YN                                                                                                                            
			       ,NVL(END_CNT , '0') END_CNT                                                                                                            
			       ,NVL( 
			              (SELECT COUNT(*) 
			                FROM BIZ_APPLICATION C 
			               WHERE C.BIZ_SEQ= BIZ_MST.BIZ_SEQ 
			              ) , '0' 
			          ) REAL_CNT
			       ,BIZ_END_YN                                                                                                                           
			       ,APP_HTML                                                                                                                            
			       ,EDIT_TYPE_YN                                                                                                                          
			       ,JIBU_CD                                                                                                                              
			       ,COMPLETE_YN                                                                                                                                         
			       ,TXT_TRADEID_YN                                                                                                                                
			       ,TXT_TRADEID_U_YN                                                                                                                                
			       ,CONTACT_CD_YN                                                                                                                                      
			       ,APP_GUIDE_SMS_EMAIL_YN                                                                                                                          
			       ,TO_CHAR(APP_SMS_RESERVED_DATE,'YYYY-MM-DD HH24:MI') AS APP_SMS_RESERVED_DATE                                                                      
			       ,APP_GUIDE_SMS_CONTENTS
			       ,APP_GUIDE_EMAIL_TITLE
			       ,APP_GUIDE_EMAIL_CONTENTS
			       ,APP_SMS_RESERVED_CONTENTS
			       ,FILE_YN
			       ,NVL(CNT,0) CNT
			       ,NVL(ATTENDANCE_ORDER_NUM,0) ATTENDANCE_ORDER_NUM
			       ,REPORT_CONTENT_STATUS              	                                                                                                                                                  
			       ,REPORT_CONTENT_IMG_HTML              	                                                                                                                                              
			       ,FILE_NAME1_REG              	                                                                                                                                                      
			       ,FILE_NAME2_REG              	                                                                                                                                                      
			       ,FILE_NAME3_REG              	                                                                                                                                                      
			       ,FILE_NAME4_REG              	                                                                                                                                                      
			       ,FILE_NAME5_REG              	                                                                                                                                                      
			       ,N_INDEX
			       ,P_ID
			       ,G_ID 
			       ,BIZ_TARGET_TYPE
			       ,BTN_TYPE            	                                                                                                                                                              
		FROM   BIZ_MST ,
		          (SELECT BIZ_SEQ B_SEQ, 
		                 COUNT(APP_SEQ) CNT, 
		                 MAX(TO_NUMBER(ATTENDANCE_ORDER_NUM)) ATTENDANCE_ORDER_NUM 
		            FROM BIZ_APPLICATION 
		           GROUP BY BIZ_SEQ 
		          ) B 
	  WHERE   DELETE_YN = 'N' 
	     AND   BIZ_SEQ = #{bizSeq} 
	     AND   BIZ_MST.BIZ_SEQ=B.B_SEQ(+)
	</select>
	
	
	<!--사업신청상세 조회건수-->
	<select id="selectBsnsreqstinqireDetailCount" parameterType="bsnsReqDataVO" resultType="int">
		SELECT /* Bsnsreqstinqire.selectBsnsreqstinqireDetailCount */
			COUNT(*) 
			FROM BIZ_APPLICATION
			WHERE BIZ_SEQ = #{bizSeq}
	</select>
	
	<!--지부코드 정보 리스트-->
	<select id="selectjibuInfoList" parameterType="bsnsReqDataVO" resultType="egovMap">
		SELECT /* Bsnsreqstinqire.selectjibuInfoList */
			 JIBU_CD 
			,JIBU_NAME 
			FROM JIBU_CITY
			GROUP BY  JIBU_CD, JIBU_NAME
			ORDER BY JIBU_CD 
	</select>
	
	<!-- 편집형 신청서 템플릿 조회 -->
	<select id="selectBizAppTemplateList" parameterType="bsnsReqDataVO" resultType="dkMap">
		SELECT /* Bsnsreqstinqire.selectBizAppTemplateList */
				 TPL_SEQ
                , TPL_NAME
				, TPL_HTML
				, INPUT_DATE
			 	, MEMBER_ID
				, DEPT_ID
				, TPL_TYPE
				, USE_YN
		 FROM BIZ_APP_TEMPLATE 
		WHERE USE_YN IS NULL 
		<if test='tplGubun != null and tplGubun != ""'>
			<if test='tplGubun == "1"'>
	           AND TPL_TYPE = 1 
	        </if>
	        <if test='tplGubun == "2" and schDeptCd != null and schDeptCd != ""'>
	           AND DEPT_ID = #{schDeptCd} 
	        </if>
	        <if test='tplGubun == "3" and userId != null and userId != ""'>
	           AND MEMBER_ID = #{userId} 
	        </if>
	    </if>
	     <choose>
	     	<when test='order == "ID"'>
	     	 	ORDER BY INPUT_DATE DESC
	     	 </when>
	     	 <when test='order == "IA"'>
	     	 	ORDER BY INPUT_DATE ASC
	     	 </when>
	     	 <when test='order == "ND"'>
	     	 	ORDER BY TPL_NAME DESC
	     	 </when>
	     	 <when test='order == "NA"'>
	     	 	ORDER BY TPL_NAME ASC
	     	 </when>
	     	<otherwise>
	     		ORDER BY INPUT_DATE DESC
	     	</otherwise>
	     </choose>
	</select>
	
	<!-- 편집형 신청서 아이템 조회 -->
	<select id="selectBizAppItemList" parameterType="bsnsReqDataVO" resultType="egovMap">
		SELECT /* Bsnsreqstinqire.selectBizAppItemList */
				  ITEM_SEQ
				, ITEM_NAME
				, ITEM_HTML
				, INPUT_DATE
				, ITEM_CODE
				, ITEM_TYPE
				, ITEM_GROUP
				, ITEM_GROUP_FIX
				, MEMBER_ID
				, DEPT_ID
				, USE_YN
		 FROM BIZ_APP_ITEM 
		WHERE USE_YN IS NULL 
		<if test='itemGubun != null and itemGubun != ""'>
			<if test='itemGubun == "1"'>
	           AND ITEM_TYPE = 1 
	        </if>
	        <if test='itemGubun == "2" and schDeptCd != null and schDeptCd != ""'>
	           AND DEPT_ID = #{schDeptCd} 
	        </if>
	        <if test='itemGubun == "3" and userId != null and userId != ""'>
	           AND MEMBER_ID = #{userId} 
	        </if>
	    </if>
	     <choose>
	     	<when test='order == "ID"'>
	     	 	ORDER BY INPUT_DATE DESC
	     	 </when>
	     	 <when test='order == "IA"'>
	     	 	ORDER BY INPUT_DATE ASC
	     	 </when>
	     	 <when test='order == "ND"'>
	     	 	ORDER BY TPL_NAME DESC
	     	 </when>
	     	 <when test='order == "NA"'>
	     	 	ORDER BY TPL_NAME ASC
	     	 </when>
	     	<otherwise>
	     		ORDER BY INPUT_DATE DESC
	     	</otherwise>
	     </choose>
	</select>
	
	<!-- 사업소개 템플릿 목록 조회 -->
	<select id="selectBizIntroTemplateList" parameterType="bsnsReqDataVO" resultType="dkMap">
		SELECT /* Bsnsreqstinqire.selectBizIntroTemplateList */
				 TPL_SEQ AS TEMPLATE_CODE
               , TPL_NAME AS TEMPLATE_NAME
               , TPL_HTML AS TEMPLATE_HTML
               , INPUT_DATE
		 FROM BIZ_EMAIL_TEMPLATE 
		 WHERE USE_YN = 'Y'
		 <if test='templateCode != null and templateCode != ""'>
		 	AND TPL_SEQ = #{templateCode}
		 </if>
		 ORDER BY TPL_SEQ ASC	
	</select>
	
	<!-- 편집형 신청서 항목 시퀀스 발번 -->
	<select id="selectBizAppItemSeq" parameterType="bizAppItemVO" resultType="int">
		SELECT /* Bsnsreqstinqire.selectBizAppItemSeq */
			BIZ_APP_ITEM_SEQ.NEXTVAL AS ITEM_SEQ
		 FROM DUAL
	</select>
	
	<!-- 편집형 신청서 항목 테이블 저장 -->
	<insert id="insertBizAppItem" parameterType="bizAppItemVO">
			INSERT /* Bsnsreqstinqire.insertBizAppItem */
			  INTO BIZ_APP_ITEM
			    ( 
				      ITEM_SEQ
				    , ITEM_NAME
				    , ITEM_HTML
				    , INPUT_DATE
				    , MEMBER_ID
				    , DEPT_ID                    	
				) 
					VALUES 
				(                      
					  #{itemSeq}   
					, #{itemName}                             
					, #{itemHtml}                             
					, SYSDATE                             
					, #{memberId}                             
					, #{deptCd}                             
				)
	</insert>
	
	<!-- 편집형 신청서 항목 삭제 -->
	<update id="deleteBizAppItem" parameterType="bizAppItemVO">
			UPDATE /* Bsnsreqstinqire.deleteBizAppItem */
			BIZ_APP_ITEM
				SET USE_YN = 'N'
				WHERE ITEM_SEQ 	= #{itemSeq}
	</update>
	
	<!-- 편집형 신청서 템플릿 시퀀스 발번 -->
	<select id="selectBizAppTplSeq" parameterType="bizAppTemplateVO" resultType="int">
		SELECT /* Bsnsreqstinqire.selectBizAppTplSeq */
			BIZ_APP_TEMPLATE_SEQ.NEXTVAL AS TPL_SEQ
		 FROM DUAL
	</select>
	
	<!-- 편집형 신청서 템플릿 테이블 저장 -->
	<insert id="insertBizAppTemplate" parameterType="bizAppTemplateVO">
			INSERT /* Bsnsreqstinqire.insertBizAppTemplate */
			  INTO BIZ_APP_TEMPLATE
			    ( 
				      TPL_SEQ
				    , TPL_NAME
				    , TPL_HTML
				    , INPUT_DATE
				    , MEMBER_ID
				    , DEPT_ID                    	
				) 
					VALUES 
				(                      
					  #{tplSeq}   
					, #{tplName}                             
					, #{tplHtml}                             
					, SYSDATE                             
					, #{memberId}                             
					, #{deptCd}                             
				)
	</insert>
	
	<!-- 이메일 템플릿 수정 임시 생성-->
		<!-- <update id="updateEmailTemplate" parameterType="bizAppTemplateVO">
			UPDATE /* Bsnsreqstinqire.updateEmailTemplate */
			BIZ_EMAIL_TEMPLATE
				SET TPL_HTML = #{tplHtml} 
				WHERE TPL_SEQ = #{tplSeq}
	</update>-->
	
	
	<!-- 편집형 신청서 템플릿 삭제 -->
	<update id="deleteBizAppTemplate" parameterType="bizAppTemplateVO">
			UPDATE /* Bsnsreqstinqire.deleteBizAppTemplate */
			BIZ_APP_TEMPLATE
				SET USE_YN = 'N'
				WHERE TPL_SEQ = #{tplSeq}
	</update>
	
	<!-- NTIS 정보 갱신 -->
	<update id="insertBizNtis" parameterType="bsnsBasicInfoVO">
			 MERGE /* Bsnsreqstinqire.insertBizNtis */
			 	INTO BIZ_MST_NTIS
			    USING DUAL
			    ON (BIZ_SEQ = #{bizSeqProv})
			WHEN MATCHED THEN
			      UPDATE 
			      	<trim prefix="SET" suffixOverrides=",">
				      	<if test='typeCd != null and typeCd != ""' >        
				            TYPECODE = NVL(trim(#{typeCd}), TYPECODE),
				        </if>
				        <if test='deptCd1 != null and deptCd1 != ""' >
				            DEPTCODE1 = NVL(trim(#{deptCd1}) , DEPTCODE1),
				        </if>
				        <if test='deptCd2 != null and deptCd2 != ""' >
				            DEPTCODE2 = NVL(trim(#{deptCd2}) , DEPTCODE2),
				        </if>
				        <if test='continentCd != null and continentCd != ""' >
				            CONTINENT_CD = NVL(trim(#{continentCd}), CONTINENT_CD),
				        </if>
				        <if test='countryCd != null and countryCd != ""' >
				            COUNTRY_CD = NVL(trim(#{countryCd}) , COUNTRY_CD),
				        </if>
				        <if test='sectorCd != null and sectorCd != ""' >
				            SECTOR_CD = NVL(trim(#{sectorCd}) , SECTOR_CD),
				        </if>
				        <if test='itemCd != null and itemCd != ""' >
				            ITEMCD_CD = NVL(trim(#{itemCd}), ITEMCD_CD)
				        </if>
			        </trim>
			WHEN NOT MATCHED THEN
			        INSERT ( BIZ_SEQ
			        		 , TYPECODE
			        		 , DEPTCODE1
			        		 , DEPTCODE2
			        		 , CONTINENT_CD
			        		 , COUNTRY_CD
			        		 , SECTOR_CD
			        		 , ITEMCD_CD )
			       VALUES ( #{bizSeqProv}
			       			 , #{typeCd} 
			       			 , #{deptCd1} 
			       			 , #{deptCd2} 
			       			 , #{continentCd} 
			       			 , #{countryCd} 
			       			 , #{sectorCd} 
			       			 , #{itemCd} )
	</update>
	
	<!-- NTIS 정보 조회 -->
	<select id="selectBizNtis" parameterType="bsnsBasicInfoVO" resultType="dkMap">
		SELECT /* Bsnsreqstinqire.selectBizNtis */
				 BIZ_SEQ
               , TYPECODE
               , DEPTCODE1
               , DEPTCODE2
               , CONTINENT_CD
               , COUNTRY_CD
               , SECTOR_CD
               , ITEMCD_CD 
		 FROM BIZ_MST_NTIS 
		 WHERE BIZ_SEQ = #{bizSeqProv}
	</select>
	
	<!-- 설문지 타입 리스트 조회 -->
	<select id="selectSurveyQuestionList" resultType="egovMap">
		SELECT /* Bsnsreqstinqire.selectSurveyQuestionList */
		QESTNR_ID,
		QESTNR_NM
		FROM CRM_COMTNQUSTNRQESMST
		ORDER BY QESTNR_ID
	</select>		
	
	<!-- 사업신청관리 시퀀스 발번 -->
	<select id="selectBizMstSeq" parameterType="bsnsBasicInfoVO" resultType="int">
		SELECT /* Bsnsreqstinqire.selectBizMstSeq */
			BIZ_MST_SEQ.NEXTVAL AS BIZ_SEQ
		 FROM DUAL
	</select>
	
	<!-- 사업신청관리 템프 테이블 저장 -->
	<insert id="insertBizAppProv" parameterType="bsnsBasicInfoVO">
			INSERT /* Bsnsreqstinqire.insertBizAppProv */
			  INTO BIZ_MST_PROV
			  	( 
				     BIZ_SEQ 
		           , BIZ_TITLE 
		           , BIZ_SDATE 
		           , BIZ_EDATE 
		           , BIZ_JOIN_SDATE 
		           , BIZ_JOIN_EDATE 
		           , BIZ_TIME
		           , BIZ_PLACE 
		           , BIZ_TARGET 
		           , BIZ_CONTENT 
		           , TEMPLATE_GB 
		           , TEMPLATE_PATH 
		           , REPORT_CONTENT 
		           , GUBUN
		           , MOBILE_YN
		           , DELETE_YN 
		           , CREATE_DATE 
		           , CREATE_ID
		           , UPDATE_DATE 
		           , UPDATE_ID
		           , COMP_NO_YN 
		           , MTYPE_YN
		           , MTYPE_U_YN 
		           , KOR_FILE_YN 
		           , ENG_FILE_YN
		           , FILE_NAME1 
		           , FILE_TEMP_NAME1 
		           , FILE_PATH1
		           , FILE_NAME2 
		           , FILE_TEMP_NAME2 
		           , FILE_PATH2
		           , FILE_NAME3 
		           , FILE_TEMP_NAME3 
		           , FILE_PATH3
		           , FILE_NAME4 
		           , FILE_TEMP_NAME4 
		           , FILE_PATH4
		           , FILE_NAME5 
		           , FILE_TEMP_NAME5 
		           , FILE_PATH5
		           , DEPT_CD
		           , TEMP_YN 
		           , NON_TARGET 
		           , END_YN
		           , END_CNT 
		           , BIZ_END_YN 
		           , APP_HTML
		           , EDIT_TYPE_YN 
		           , JIBU_CD
		           , CONTACT_CD_YN 
		           , APP_GUIDE_SMS_EMAIL_YN 
		           , APP_SMS_RESERVED_DATE 
		           , APP_GUIDE_SMS_CONTENTS 
		           , APP_GUIDE_EMAIL_TITLE
		           , APP_GUIDE_EMAIL_CONTENTS 
		           , APP_SMS_RESERVED_CONTENTS 
		           , REPORT_CONTENT_STATUS 
		           , FILE_NAME1_REG
		           , FILE_NAME2_REG 
		           , FILE_NAME3_REG 
		           , FILE_NAME4_REG 
		           , FILE_NAME5_REG 
		           , P_ID
		           , G_ID
		           , BIZ_TARGET_TYPE
		           , BTN_TYPE
		           , GW_CONSIDER_NO1
		           , GW_CONSIDER_NO2                  	
				)  
				    VALUES 
				(                       
				     #{bizSeqProv}
				   , #{bizTitle}
			       , TO_DATE (#{bizSdate}, 'YYYY-MM-DD')
			       , TO_DATE (#{bizEdate}, 'YYYY-MM-DD')
			       , TO_DATE (#{bizJoinSdate}, 'YYYY-MM-DD')
			       , TO_DATE (#{bizJoinEdate}, 'YYYY-MM-DD')
			       , #{bizTime}
			       , #{bizPlace}
			       , #{bizTarget}
			       , #{bizContent}
			       , #{templateGb}
			       , #{templatePath}
			       , #{reportContent}
			       , #{gubun}
			       , #{mobileYn}
			       , 'N'
			       , SYSDATE
			       , #{userId}
			       , SYSDATE
			       , #{userId}
			       , #{compNoYn}
			       , #{mtypeYn}
			       , #{mtypeUYn}
			       , #{korFileYn}
			       , #{engFileYn}
			       , #{fileName1}
			       , #{fileTempName1}
			       , #{filePath1}
			       , #{fileName2}
			       , #{fileTempName2}
			       , #{filePath2}
			       , #{fileName3}
			       , #{fileTempName3}
			       , #{filePath3}
			       , #{fileName4}
			       , #{fileTempName4}
			       , #{filePath4}
			       , #{fileName5}
			       , #{fileTempName5}
			       , #{filePath5}
			       , #{deptCd}
			       , #{tempYn}
			       , #{nonTarget}
			       , #{endYn}
			       , #{endCnt}
			       , #{bizEndYn}
			       , #{appHtml}
			       , #{editTypeYn}
			       , #{jibuCd}
			       , #{contactCdYn}
			       , #{appGuideSmsEmailYn}
			       , TO_DATE (#{appSmsReservedDate}, 'YYYY-MM-DD HH24:MI')
			       , #{appGuideSmsContents}
			       , #{appGuideEmailTitle}
			       , #{appGuideEmailContents}
			       , #{appSmsReservedContents}
			       , #{reportContentStatus}
			       , #{fileName1Reg}
			       , #{fileName2Reg}
			       , #{fileName3Reg}
			       , #{fileName4Reg}
			       , #{fileName5Reg}
			       , #{pId}
			       , #{gId}
			       , #{bizTargetType}
			       , #{btnType}
			       , #{gwConsiderNo1}
		           , #{gwConsiderNo2}                      
				)
	</insert>
	
	<!-- 사업신청관리 템프 테이블 조회 -->
	<select id="selectBizAppViewProv" parameterType="bsnsBasicInfoVO" resultType="dkMap">
			SELECT  /* Bsnsreqstinqire.selectBizAppViewProv */                                                                                                                                                                                     
			        BIZ_SEQ                                                                                                                                                                               
			       ,BIZ_TITLE                                                                                                                                                                             
			       ,TO_CHAR(BIZ_SDATE,'YYYY-MM-DD') AS BIZ_SDATE                                                                                                                                          
			       ,TO_CHAR(BIZ_EDATE,'YYYY-MM-DD') AS BIZ_EDATE                                                                                                                                          
			       ,TO_CHAR(BIZ_JOIN_SDATE,'YYYY-MM-DD') AS BIZ_JOIN_SDATE                                                                                                                               
			       ,TO_CHAR(BIZ_JOIN_EDATE,'YYYY-MM-DD') AS BIZ_JOIN_EDATE
			       ,BIZ_TIME                                                                                                                                                                              
			       ,BIZ_PLACE                                                                                                                                                                             
			       ,COMP_NO_YN                                                                                                                                                                            
			       ,BIZ_TARGET                                                                                                                                                                            
			       ,BIZ_CONTENT                                                                                                                                                                           
			       ,TEMPLATE_GB                                                                                                                                                                           
			       ,TEMPLATE_PATH                                                                                                                                                                         
			       ,REPORT_CONTENT                                                                                                                                                                        
			       ,MOBILE_YN                                                                                                                                                                             
			       ,COMP_NO_YN                                                                                                                                                                            
			       ,DELETE_YN                                                                                                                                                                             
			       ,CREATE_DATE                                                                                                                                                                           
			       ,CREATE_ID                                                                                                                                                                            
			       ,UPDATE_DATE                                                                                                                                                                           
			       ,UPDATE_ID                                                                                                                                                                            
			       ,MTYPE_YN                                                                                                                                                                              
			       ,MTYPE_U_YN                                                                                                                                                                            
			       ,NVL(KOR_FILE_YN,'N') KOR_FILE_YN                                                                                                                                                     
			       ,NVL(ENG_FILE_YN,'N') ENG_FILE_YN	                                                                                                                                                  
			       ,FILE_NAME1                                                                                                                                                       
			       ,FILE_TEMP_NAME1                                                                                                                                                                      
			       ,FILE_PATH1                                                                                                                                                                        
			       ,FILE_NAME2	                                                                                                                                                                          
			       ,FILE_TEMP_NAME2	                                                                                                                                                                      
			       ,FILE_PATH2                                                                                                                                                                        
			       ,FILE_NAME3	                                                                                                                                                                          
			       ,FILE_TEMP_NAME3                                                                                                                                                                       
			       ,FILE_PATH3                                                                                                                                                                            
			       ,FILE_NAME4	                                                                                                                                                                          
			       ,FILE_TEMP_NAME4	                                                                                                                                                                      
			       ,FILE_PATH4	                                                                                                                                                                          
			       ,FILE_NAME5	                                                                                                                                                                          
			       ,FILE_TEMP_NAME5                                                                                                                                                                       
			       ,FILE_PATH5                                                                                                                                                                            
			       ,DEPT_CD                	                                                                                                                                                              
			       ,TEMP_YN                	                                                                                                                                  
			       ,NON_TARGET                                                                                                                      
			       ,END_YN                                                                                                                            
			       ,NVL(END_CNT , '0') END_CNT                                                                                                            
			       ,BIZ_END_YN                                                                                                                           
			       ,APP_HTML                                                                                                                            
			       ,EDIT_TYPE_YN                                                                                                                          
			       ,JIBU_CD                                                                                                                              
			       ,COMPLETE_YN                                                                                                                                         
			       ,TXT_TRADEID_YN                                                                                                                                
			       ,TXT_TRADEID_U_YN                                                                                                                                
			       ,CONTACT_CD_YN                                                                                                                                      
			       ,APP_GUIDE_SMS_EMAIL_YN                                                                                                                          
			       ,TO_CHAR(APP_SMS_RESERVED_DATE,'YYYY-MM-DD HH24:MI') AS APP_SMS_RESERVED_DATE                                                                      
			       ,APP_GUIDE_SMS_CONTENTS                                                                                                                             
			       ,APP_GUIDE_EMAIL_TITLE                                                                                                                                 
			       ,APP_GUIDE_EMAIL_CONTENTS                                                                                                                             
			       ,APP_SMS_RESERVED_CONTENTS                                                                                                                            
			       ,FILE_YN                                                                                                                                            
			       ,REPORT_CONTENT_STATUS              	                                                                                                                                                  
			       ,REPORT_CONTENT_IMG_HTML              	                                                                                                                                              
			       ,FILE_NAME1_REG              	                                                                                                                                                      
			       ,FILE_NAME2_REG              	                                                                                                                                                      
			       ,FILE_NAME3_REG              	                                                                                                                                                      
			       ,FILE_NAME4_REG              	                                                                                                                                                      
			       ,FILE_NAME5_REG              	                                                                                                                                                      
			       ,FILE_NAME6_REG              	                                                                                                                                                      
			       ,FILE_NAME7_REG              	                                                                                                                                                      
			       ,P_ID
			       ,G_ID 
			       ,BIZ_TARGET_TYPE
			       ,BTN_TYPE            	                                                                                                                                                              
		FROM   BIZ_MST_PROV
	  WHERE   DELETE_YN = 'N' 
	     AND   BIZ_SEQ = #{bizSeqProv} 
	</select>
	
	
	
	<!-- 지부 게시판 그룹값 조회 -->
	<select id="selectMaxGroup" parameterType="bsnsBasicInfoVO" resultType="int">
		SELECT /* Bsnsreqstinqire.selectMaxGroup */
			NVL(MAX(N_GROUP), 0) MAXGROUP
		 FROM GRP_POST@KTBLOG
		 WHERE N_BOARDIDX = #{nBoardidx}
	</select>
	
	<!-- 지부게시판 갱신 -->
	<update id="updateGrpPost" parameterType="bsnsBasicInfoVO">
			UPDATE /* Bsnsreqstinqire.updateGrpPost */
				GRP_POST@KTBLOG
				SET 	S_SITEID = #{sSiteid}
				      , N_BOARDIDX = #{nBoardidx}                                                                
					  , S_TITLE = #{bizTitle}                                                                   
					  , S_CONTENT = #{reportContentImgHtml}                                                                 
					  , S_USERIP = #{userIp}                                                                  
					  , N_GROUP = #{nGroup}                                                                   
					  , COMM_CODE1 = #{typeCd}
					  , N_THEME1 = #{deptCd1} 
					  , N_THEME2 = #{deptCd2}
					  , POST_START_DATE = #{bizSdate}
					  , POST_END_DATE = #{bizEdate}
			WHERE N_INDEX = #{nIndex}                                                                
	</update>
	
	<!-- 지부게시판 삭제 -->
	<delete id="deleteGrpPostRef" parameterType="bsnsBasicInfoVO">
		DELETE /* Bsnsreqstinqire.deleteGrpPostRef */
		 FROM ktblog.GRP_POST_REF@TRADE 
		WHERE N_INDEX = #{nIndex} 
	</delete>
	
	<!-- 게시판 대륙정보 저장 -->
	<insert id="insertGrpPostRefA001" parameterType="bsnsBasicInfoVO">
			INSERT /* Bsnsreqstinqire.insertGrpPostRefA001 */
			  INTO ktblog.GRP_POST_REF@TRADE (N_INDEX ,REF_GB ,REF_CD )
			  SELECT #{nIndex} idx, 'A001' REF_GB, col FROM (   
				SELECT TRIM(SUBSTR(','|| #{continentCd} ||',',   
				                 INSTR(','|| #{continentCd} ||',',',', 1,NO)+1,   
				                (INSTR(','|| #{continentCd} ||',',',', 1,NO+1)-   
				                 INSTR(','|| #{continentCd} ||',',',', 1,NO))-1)) col   
				            FROM COPY_T y   
				            WHERE y.NO <![CDATA[<=]]> (LENGTH( #{continentCd} )-   
				                   LENGTH(REPLACE( #{continentCd} ,',','')))+1   
				) WHERE col IS NOT NULL 
	</insert>
	
	<!-- 게시판 국가정보 저장 -->
	<insert id="insertGrpPostRefA002" parameterType="bsnsBasicInfoVO">
			INSERT /* Bsnsreqstinqire.insertGrpPostRefA002 */
			  INTO ktblog.GRP_POST_REF@TRADE (N_INDEX ,REF_GB ,REF_CD )
			  SELECT #{nIndex} idx, 'A002' REF_GB, col FROM (   
				SELECT TRIM(SUBSTR(','|| #{countryCd} ||',',   
				                 INSTR(','|| #{countryCd} ||',',',', 1,NO)+1,   
				                (INSTR(','|| #{countryCd} ||',',',', 1,NO+1)-   
				                 INSTR(','|| #{countryCd} ||',',',', 1,NO))-1)) col   
				            FROM COPY_T y   
				            WHERE y.NO <![CDATA[<=]]> (LENGTH( #{countryCd} )-   
				                   LENGTH(REPLACE( #{countryCd} ,',','')))+1   
				) WHERE col IS NOT NULL 
	</insert>
	
	<!-- 게시판 업종정보 저장 -->
	<insert id="insertGrpPostRefA003" parameterType="bsnsBasicInfoVO">
			INSERT /* Bsnsreqstinqire.insertGrpPostRefA003 */
			  INTO ktblog.GRP_POST_REF@TRADE (N_INDEX ,REF_GB ,REF_CD )
			  SELECT #{nIndex} idx, 'A003' REF_GB, col FROM (   
				SELECT TRIM(SUBSTR(','|| #{sectorCd} ||',',   
				                 INSTR(','|| #{sectorCd} ||',',',', 1,NO)+1,   
				                (INSTR(','|| #{sectorCd} ||',',',', 1,NO+1)-   
				                 INSTR(','|| #{sectorCd} ||',',',', 1,NO))-1)) col   
				            FROM COPY_T y   
				            WHERE y.NO <![CDATA[<=]]> (LENGTH( #{sectorCd} )-   
				                   LENGTH(REPLACE( #{sectorCd} ,',','')))+1   
				) WHERE col IS NOT NULL 
	</insert>
	
	<!-- 게시판 항목정보 저장 -->
	<insert id="insertGrpPostRefA004" parameterType="bsnsBasicInfoVO">
			INSERT /* Bsnsreqstinqire.insertGrpPostRefA004 */
			  INTO ktblog.GRP_POST_REF@TRADE (N_INDEX ,REF_GB ,REF_CD )
			  SELECT #{nIndex} idx, 'A004' REF_GB, col FROM (   
				SELECT TRIM(SUBSTR(','|| #{itemCd} ||',',   
				                 INSTR(','|| #{itemCd} ||',',',', 1,NO)+1,   
				                (INSTR(','|| #{itemCd} ||',',',', 1,NO+1)-   
				                 INSTR(','|| #{itemCd} ||',',',', 1,NO))-1)) col   
				            FROM COPY_T y   
				            WHERE y.NO <![CDATA[<=]]> (LENGTH( #{itemCd} )-   
				                   LENGTH(REPLACE( #{itemCd} ,',','')))+1   
				) WHERE col IS NOT NULL 
	</insert>
	
	
	<!-- 지부게시판 시퀀스 발번 -->
	<select id="selectSeqGrpPost" parameterType="bsnsBasicInfoVO" resultType="int">
		SELECT /* Bsnsreqstinqire.selectSeqGrpPost */
			SEQ_GRPPOST.NEXTVAL@KTBLOG AS N_INDEX
		 FROM DUAL
	</select>
	
	<!-- 지부게시판 테이블 저장 -->
	<insert id="insertGrpPost" parameterType="bsnsBasicInfoVO">
			INSERT /* Bsnsreqstinqire.insertGrpPost */
			  INTO GRP_POST@KTBLOG
			  ( N_INDEX
			  , S_SITEID
			  , N_BOARDIDX
			  , S_TITLE
			  , S_CONTENT
			  , S_USERIP
			  , N_GROUP
			  , S_CHARACTERSET
			  , N_ISHTML
			  , N_ENABLESCRAP
			  , N_PARENT
			  , N_ORDER
			  , N_DEPTH
			  , N_LICENSE
			  , N_PUBLIC
			  , COMM_CODE1
			  , N_THEME1
			  , N_THEME2
			  , POST_START_DATE
			  , POST_END_DATE
			  ) VALUES (
			    #{nIndex}
			  , #{sSiteid}
			  , #{nBoardidx}
			  , #{bizTitle} 
			  , #{reportContentImgHtml} 
			  , #{userIp} 
			  , #{nGroup}
			  , 'EUC-KR'
			  , 1
			  , 0
			  , 0
			  , 0
			  , 0
			  , 1
			  , 1
			  , #{typeCd}
			  , #{deptCd1} 
			  , #{deptCd2} 
			  , #{bizSdate}
			  , #{bizEdate}
			  )
	</insert>
	
	<!-- 지부게시판 갱신 -->
	<update id="updateGrpBoard" parameterType="bsnsBasicInfoVO">
			UPDATE /* Bsnsreqstinqire.updateGrpBoard */
			KTBLOG.GRP_BOARD@TRADE
				SET N_POSTCOUNT = N_POSTCOUNT + 1
			WHERE N_INDEX = #{nBoardidx}                                                                
	</update>
	
	<!-- 사업신청관리 정보 갱신  -->
	<update id="updateBizApp" parameterType="bsnsBasicInfoVO">
			UPDATE /* Bsnsreqstinqire.updateBizApp */
				BIZ_MST
				SET 	BIZ_TITLE = #{bizTitle}
				      , BIZ_SDATE = #{bizSdate}                                                                
					  , BIZ_EDATE = #{bizEdate}                                                                   
					  , BIZ_JOIN_SDATE = #{bizJoinSdate}                                                                 
					  , BIZ_JOIN_EDATE = #{bizJoinEdate}                                                                  
					  , BIZ_TIME = #{bizTime}                                                                   
					  , BIZ_PLACE = #{bizPlace}
					  , BIZ_TARGET = #{bizTarget}
					  , BIZ_CONTENT = #{bizContent}
					  , TEMPLATE_GB = #{templateGb}
					  , TEMPLATE_PATH = #{templatePath}
					  , REPORT_CONTENT = #{reportContent}
					  , GUBUN = #{gubun}
					  , MOBILE_YN = #{mobileYn}
					  , COMP_NO_YN = #{compNoYn}
					  , UPDATE_DATE = SYSDATE
					  , UPDATE_ID = #{userId}
					  , MTYPE_YN = #{mtypeYn}
					  , MTYPE_U_YN = #{mtypeUYn}
					  , KOR_FILE_YN = #{korFileYn}
					  , ENG_FILE_YN = #{engFileYn}
					  
					  <if test='excelFile1Yn == "Y"'>
					  , FILE_NAME1 = #{fileName1}
					  , FILE_TEMP_NAME1 = #{fileTempName1}
					  , FILE_PATH1 = #{filePath1}
					  </if>
					  <if test='excelFile2Yn == "Y"'>
					  , FILE_NAME2 = #{excelFile2Yn}
					  , FILE_TEMP_NAME2 = #{fileTempName2}
					  , FILE_PATH2 = #{filePath2}
					  </if>
					  <if test='excelFile3Yn == "Y"'>
					  , FILE_NAME3 = #{fileName3}
					  , FILE_TEMP_NAME3 = #{fileTempName3}
					  , FILE_PATH3 = #{filePath3}
					  </if>
					  <if test='excelFile4Yn  == "Y"'>
					  , FILE_NAME4 = #{fileName4}
					  , FILE_TEMP_NAME4 = #{fileTempName4}
					  , FILE_PATH4 = #{filePath4}
					  </if>
					  <if test='excelFile5Yn  == "Y"'>
					  , FILE_NAME5 = #{fileName5}
					  , FILE_TEMP_NAME5 = #{fileTempName5}
					  , FILE_PATH5 = #{filePath5}
					  </if>
					  , TEMP_YN = #{tempYn}
					  , BIZ_TARGET_TYPE = #{bizTargetType}
					  , END_YN = #{endYn}
					  , END_CNT = #{endCnt}
					  , BIZ_END_YN = #{bizEndYn}
					  , JIBU_CD = #{jibuCd}
					  , CONTACT_CD_YN = #{contactCdYn}
					  , APP_GUIDE_SMS_EMAIL_YN = #{appGuideSmsEmailYn} 
		           	  , APP_SMS_RESERVED_DATE = TO_DATE (#{appSmsReservedDate}, 'YYYY-MM-DD HH24:MI')
		              , APP_GUIDE_SMS_CONTENTS = #{appGuideSmsContents} 
		              , APP_GUIDE_EMAIL_TITLE = #{appGuideEmailTitle}
		              , APP_GUIDE_EMAIL_CONTENTS = #{appGuideEmailContents} 
		              , APP_SMS_RESERVED_CONTENTS = #{appSmsReservedContents}
					  <if test='modifyCnt == "Y"'>
					  , APP_HTML = #{appHtml}
					  , EDIT_TYPE_YN = #{editTypeYn}
					  </if>
					  , REPORT_CONTENT_STATUS = #{reportContentStatus}
					  , REPORT_CONTENT_IMG_HTML = #{reportContentImgHtml}
					  , FILE_NAME1_REG = #{fileName1Reg}
					  , FILE_NAME2_REG = #{fileName2Reg}
					  , FILE_NAME3_REG = #{fileName3Reg}
					  , FILE_NAME4_REG = #{fileName4Reg}
					  , FILE_NAME5_REG = #{fileName5Reg}
					  , N_INDEX = #{nIndex}
					  , P_ID = #{pId}
					  , G_ID = #{gId}
					  , BTN_TYPE = #{btnType}
			WHERE BIZ_SEQ = #{bizSeq}                                                               
	</update>
	
	<!-- 사업신청관리 Biz app 상담회 및 사절단 신청자 건수 조회 -->
	<select id="selectBizAppConsultCount" parameterType="bsnsBasicInfoVO" resultType="int">
		SELECT /* Bsnsreqstinqire.selectBizAppConsultCount */
			COUNT(*) 
			FROM BIZ_APP_CONSULT
			WHERE BIZ_SEQ = #{bizSeq}
	</select>
	
	<!-- 사업신청관리 Biz app 상담회 및 사절단 신청자 Sub info 건수 조회 -->
	<select id="selectBizAppConsultSubCount" parameterType="bsnsBasicInfoVO" resultType="int">
		SELECT /* Bsnsreqstinqire.selectBizAppConsultSubCount */
			COUNT(*) 
			FROM BIZ_APP_CONSULT_SUB
			WHERE BIZ_SEQ = #{bizSeq}
	</select>
	
	
	<!-- 사업신청관리 Biz master 삭제 -->
	<update id="deleteBizMst" parameterType="bsnsBasicInfoVO">
			UPDATE /* Bsnsreqstinqire.deleteBizMst */
				BIZ_MST
				SET	UPDATE_DATE = SYSDATE 
					  , UPDATE_ID = #{userId}         
					  , DELETE_YN = 'Y'       
				WHERE BIZ_SEQ = #{bizSeq}       
	</update>
	
	<!-- 사업신청관리 Biz app 삭제 -->
	<update id="deleteBizApp" parameterType="bsnsBasicInfoVO">
			UPDATE /* Bsnsreqstinqire.deleteBizApp */
				BIZ_APPLICATION
				SET	UPDATE_DATE = SYSDATE 
					  , UPDATE_ID = #{userId}         
					  , DELETE_YN = 'Y'       
				WHERE BIZ_SEQ = #{bizSeq}  
	</update>
	
	<!-- 사업신청관리 Biz app 상담회 및 사절단 신청자삭제 -->
	<update id="deleteBizAppConsult" parameterType="bsnsBasicInfoVO">
			UPDATE /* Bsnsreqstinqire.deleteBizAppConsult */
				BIZ_APP_CONSULT
				SET	UPDATE_DATE = SYSDATE 
					  , UPDATE_ID = #{userId}         
					  , DELETE_YN = 'Y'       
				WHERE BIZ_SEQ = #{bizSeq}  
	</update>
	
	<!-- 사업신청관리 Biz app 상담회 및 사절단 신청자 Sub info 삭제 -->
	<update id="deleteBizAppConsultSub" parameterType="bsnsBasicInfoVO">
			UPDATE /* Bsnsreqstinqire.deleteBizAppConsultSub */
				BIZ_APP_CONSULT_SUB
				SET	DELETE_YN = 'Y'       
				WHERE BIZ_SEQ = #{bizSeq}  
	</update>
	
	<!-- 사업신청관리 정보 저장 -->
	<insert id="insertBizApp" parameterType="bsnsBasicInfoVO">
			INSERT /* Bsnsreqstinqire.insertBizApp */
			  INTO BIZ_MST
			  (  BIZ_SEQ
			  , BIZ_TITLE
			  , BIZ_SDATE                                                                                                                                
			  , BIZ_EDATE
			  , BIZ_JOIN_SDATE
			  , BIZ_JOIN_EDATE
			  , BIZ_TIME
			  , BIZ_PLACE                                                                                               
			  , BIZ_TARGET
			  , BIZ_CONTENT                                                                                                                               
			  , TEMPLATE_GB
			  , TEMPLATE_PATH
			  , REPORT_CONTENT
			  , GUBUN                                                                                                           
			  , MOBILE_YN
			  , DELETE_YN
			  , CREATE_DATE                                                                                                                            
			  , CREATE_ID
			  , UPDATE_DATE
			  , UPDATE_ID
			  , COMP_NO_YN
			  , MTYPE_YN
			  , MTYPE_U_YN                                                                                          
			  , KOR_FILE_YN
			  , ENG_FILE_YN
			  , FILE_NAME1
			  , FILE_TEMP_NAME1
			  , FILE_PATH1                                                                                            
			  , FILE_NAME2
			  , FILE_TEMP_NAME2
			  , FILE_PATH2                                                                                                                      
			  , FILE_NAME3
			  , FILE_TEMP_NAME3
			  , FILE_PATH3                                                                                                                      
			  , FILE_NAME4
			  , FILE_TEMP_NAME4
			  , FILE_PATH4                                                                                                                      
			  , FILE_NAME5
			  , FILE_TEMP_NAME5
			  , FILE_PATH5                                                                                                                      
			  , DEPT_CD
			  , TEMP_YN
			  , BIZ_TARGET_TYPE                                                                                        
			  , END_YN
			  , END_CNT
			  , BIZ_END_YN
			  , APP_HTML
			  , EDIT_TYPE_YN
			  , JIBU_CD
			  , CONTACT_CD_YN
			  , APP_GUIDE_SMS_EMAIL_YN
			  , APP_SMS_RESERVED_DATE                                                                                                                
			  , APP_GUIDE_SMS_CONTENTS
			  , APP_GUIDE_EMAIL_TITLE
			  , APP_GUIDE_EMAIL_CONTENTS
			  , APP_SMS_RESERVED_CONTENTS
			  , REPORT_CONTENT_STATUS
			  , REPORT_CONTENT_IMG_HTML  
			  , FILE_NAME1_REG
			  , FILE_NAME2_REG
			  , FILE_NAME3_REG
			  , FILE_NAME4_REG
			  , FILE_NAME5_REG
			  , FILE_NAME6_REG
			  , FILE_NAME7_REG
			  , N_INDEX
			  , P_ID
			  , G_ID
			  , BTN_TYPE
			  , GW_CONSIDER_NO1
		      , GW_CONSIDER_NO2
			 ) VALUES ( 
			 	 #{bizSeq}                                                                                                                                                                       
			 	, #{bizTitle}                                                                                                                            
			 	, TO_DATE (#{bizSdate}, 'yyyy-mm-dd')                                                                                                     
			 	, TO_DATE (#{bizEdate}, 'yyyy-mm-dd')                                                                                                     
			 	, TO_DATE (#{bizJoinSdate}, 'yyyy-mm-dd')                                                                                                     
			 	, TO_DATE (#{bizJoinEdate}, 'yyyy-mm-dd')                                                                                                     
			 	, #{bizTime}                                                                                                                              
			 	, #{bizPlace}                                                                                                                             
			 	, #{bizTarget}                                                                                                                             
			 	, #{bizContent}                                                                                                                             
			 	, #{templateGb}                                                                                                                             
			 	, #{templatePath}                                                                                                                             
			 	, #{reportContent}  
			 	, #{gubun}                                                                                                                       
			 	, #{mobileYn}                                                                                                                            
			 	, 'N'                                                                                                                           
			 	, SYSDATE                                                                                                                        
			 	, #{userId}                                                                                                                             
			 	, SYSDATE                                                                                                                        
			 	, #{userId}                                                                                                                             
			 	, #{compNoYn}                                                                                                                             
			 	, #{mtypeYn}                                                                                                                             
			 	, #{mtypeUYn}                                                                                                                        
			 	, #{korFileYn}                                                                                                                             
			 	, #{engFileYn}                                                                                                                             
			 	, #{fileName1}                                                                                                                             
			 	, #{fileTempName1}                                                                                                                             
			 	, #{filePath1}                                                                                                                             
			 	, #{fileName2}                                                                                                                                  
			 	, #{fileTempName2}                                                                                                                                 
			 	, #{filePath2}                                                                                                                                     
			 	, #{fileName3}                                                                                                                                  
			 	, #{fileTempName3}                                                                                                                                 
			 	, #{filePath3}                                                                                                                                     
			 	, #{fileName4}                                                                                                                                  
			 	, #{fileTempName4}                                                                                                                                 
			 	, #{filePath4}                                                                                                                                     
			 	, #{fileName5}                                                                                                                                  
			 	, #{fileTempName5}                                                                                                                                 
			 	, #{filePath5}                                                                                                                                     
			 	, #{deptCd}                                                                                                                             
			 	, #{tempYn}                         
			 	, #{bizTargetType}                                                                                                                     
			 	, #{endYn}                                                                                                                                              
			 	, #{endCnt}                                                                                                                                             
			 	, #{bizEndYn}                                                                                                                                            
			 	, #{appHtml}                                                                                                                           
			 	, #{editTypeYn}                                                                                                                       
			 	, #{jibuCd}                                                                                                                                                                   
			 	, #{contactCdYn}                                                                                                                                                   
			 	, #{appGuideSmsEmailYn}                                                                                                                                                     
			 	, TO_DATE (#{appSmsReservedDate}, 'YYYY-MM-DD HH24:MI')                                                                                                            
			 	, #{appGuideSmsContents}                                                                                                       
			 	, #{appGuideEmailTitle}                                                                                                       
			 	, #{appGuideEmailContents}                                                                                                       
			 	, #{appSmsReservedContents}                                                                                                       
			 	, #{reportContentStatus}                                                                                                                           
			 	, #{reportContentImgHtml}                                                                                                                           
			 	, #{fileName1Reg}                                                                                                                           
			 	, #{fileName2Reg}                                                                                                                           
			 	, #{fileName3Reg}                                                                                                                           
			 	, #{fileName4Reg}                                                                                                                           
			 	, #{fileName5Reg}                                                                                                                           
			 	, #{fileName6Reg}                                                                                                                           
			 	, #{fileName7Reg}                                                                                                                           
			 	, #{nIndex}                                                      
			 	, #{pId}
			 	, #{gId}
			 	, #{btnType}
			 	, #{gwConsiderNo1}
		        , #{gwConsiderNo2}
			 )         
	</insert>
	
	<!--##################################사업신청상세 end##################################-->
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<!--##################################사업신청자 start##################################-->
	<!--사업신청조회 리스트-->
	<select id="selectIntegrateBizList" parameterType="bsnsReqDataVO" resultType="egovMap">
		SELECT /* Bsnsreqstinqire.selectIntegrateBizList */
				 BB.*, 
		         CASE 
		             WHEN SATISFACTION_YN_CNT <![CDATA[>]]> 0 
		             THEN 6 
		             WHEN COMPLETE_YN = 'Y' 
		             THEN 5 
		             WHEN ATTENDANCE_ORDER_NUM_CNT <![CDATA[>]]> 0 
		             THEN 4 
		             WHEN CNT <![CDATA[>]]> 0 
		             THEN 3 
		             WHEN MAKETING_CNT <![CDATA[>]]> 0 
		             THEN 2 
		             ELSE 1 
		         END PROC_STEP, 
		         CASE 
		             WHEN TEMP_YN = 'Y' 
		             THEN '임시저장' 
		             WHEN BIZ_END_YN = 'Y' 
		             THEN '공지내림' 
		             WHEN PROC_STATUS = 'Y' 
		             THEN '공지중' 
		             ELSE '공지종료' 
		         END PROC_STATUS_NM 
		    FROM 
		         (SELECT AA.* , 
		                NVL(CNT,0) CNT , 
		                NVL ( SATISFACTION_YN_CNT, 0 ) SATISFACTION_YN_CNT , 
		                NVL ( ATTENDANCE_ORDER_NUM_CNT, 0 ) ATTENDANCE_ORDER_NUM_CNT , 
		                (SELECT COUNT(*) MAKETING_CNT 
		                  FROM MARKETING_KEY 
		                 WHERE BIZ_SEQ = AA.BIZ_SEQ
		                ) MAKETING_CNT , 
		                NVL(PROC_STATUS,'N' ) PROC_STATUS 
		           FROM 
		                (SELECT a.*, 
		                       ROWNUM AS RNUM 
		                  FROM 
		                       (SELECT BIZ_SEQ, 
		                              BIZ_TITLE, 
		                              to_char(BIZ_SDATE,'YYYY-MM-DD') AS BIZ_SDATE , 
		                              to_char(BIZ_EDATE,'YYYY-MM-DD') AS BIZ_EDATE , 
		                              to_char(BIZ_JOIN_SDATE,'YYYY-MM-DD') AS BIZ_JOIN_SDATE , 
		                              to_char(BIZ_JOIN_EDATE,'YYYY-MM-DD') AS BIZ_JOIN_EDATE , 
		                              BIZ_TIME, 
		                              BIZ_PLACE, 
		                              GUBUN, 
		                              BIZ_TARGET, 
		                              BIZ_CONTENT, 
		                              TEMPLATE_GB, 
		                              TEMPLATE_PATH, 
		                              MOBILE_YN, 
		                              DELETE_YN, 
		                              to_char(CREATE_DATE,'yyyy-mm-dd hh24:mi:ss') CREATE_DATE, 
		                              CREATE_ID, 
		                              UPDATE_DATE, 
		                              UPDATE_ID, 
		                              DEPT_CD, 
		                              NVL(MTYPE_YN,'N') MTYPE_YN, 
		                              TEMP_YN, 
		                              COMPLETE_YN, 
		                              BIZ_END_YN, 
		                              COUNT (1) OVER (PARTITION BY '') TOTALCNT 
		                         FROM BIZ_MST A 
		                        WHERE DELETE_YN = 'N'
				               <if test='pageGubun != null and pageGubun != "" and pageGubun =="bsnsreqstinqireApplcntList"'>
				               		AND BIZ_SEQ = #{schBizSeq}
				               </if>
				               <if test='pageGubun == null and pageGubun == ""'>
				               		<if test='schBizGubun == "1"'>
				               			AND CREATE_ID = #{schCreateId}
				               		</if>
				               		<if test='schBizGubun == "2"'>
				               			AND DEPT_CD = #{schDeptCd}
				               		</if>
				               </if>
				               <if test='schStatus == "1"'>
			               			AND COMPLETE_YN ='N'
			               		</if>
			               		<if test='schStatus == "2"'>
			               			AND COMPLETE_YN ='Y'
			               		</if>
			               		<if test='schBizTitle != null and schBizTitle !=""'>
			               			AND BIZ_TITLE LIKE '%' || #{schBizTitle} || '%' 
			               		</if>
		               			ORDER BY BIZ_SEQ DESC 
				                     ) a 
				              ) AA , 
				              (SELECT COUNT(APP_SEQ) AS CNT, 
				                     biz_seq 
				                FROM BIZ_APPLICATION 
				               WHERE DELETE_YN = 'N' 
				               GROUP BY biz_seq
				              ) a , 
				              (SELECT COUNT(SATISFACTION_YN) SATISFACTION_YN_CNT, 
				                     biz_seq 
				                FROM BIZ_APPLICATION 
				               WHERE DELETE_YN = 'N' 
				                     AND SATISFACTION_YN = 'Y' 
				               GROUP BY biz_seq 
				              ) c , 
				              (SELECT COUNT(ATTENDANCE_ORDER_NUM) ATTENDANCE_ORDER_NUM_CNT , 
				                     biz_seq 
				                FROM BIZ_APPLICATION 
				               WHERE DELETE_YN = 'N' 
				                     AND ATTENDANCE_ORDER_NUM IS NOT NULL 
				               GROUP BY biz_seq
				              ) d , 
				              (SELECT 'Y' PROC_STATUS , 
				                     biz_seq 
				                FROM BIZ_MST B 
				               WHERE TO_CHAR(BIZ_JOIN_SDATE, 'YYYY-MM-DD') <![CDATA[<= ]]> TO_CHAR(SYSDATE, 'YYYY-MM-DD') 
				                     AND TO_CHAR(BIZ_JOIN_EDATE, 'YYYY-MM-DD') <![CDATA[>= ]]> TO_CHAR(SYSDATE, 'YYYY-MM-DD') 
				              ) e 
				        WHERE 1= 1 
				              AND AA.biz_seq = a.biz_seq(+) 
				              AND AA.biz_seq = c.biz_seq(+) 
				              AND AA.biz_seq = d.biz_seq(+) 
				              AND AA.biz_seq = e.biz_seq(+)
				           <if test='pageGubun == null or pageGubun == ""'>
				           	  AND AA.RNUM BETWEEN #{firstIndex} AND #{lastIndex} 
				           </if>     
				        ORDER BY AA.BIZ_SEQ DESC ) BB
		   
	</select>
<!--##################################사업신청자 end##################################-->

	<!-- 사업신청관리상세 -->
	<select id="getBizAppView" parameterType="String" resultMap="egovMap">
		SELECT /* Bsnsreqstinqire.getBizAppView */
		       BIZ_SEQ,
		       BIZ_TITLE,
		       TO_CHAR(BIZ_SDATE,'YYYY-MM-DD') AS BIZ_SDATE ,
		       TO_CHAR(BIZ_EDATE,'YYYY-MM-DD') AS BIZ_EDATE ,
		       TO_CHAR(BIZ_JOIN_SDATE,'YYYY-MM-DD') AS BIZ_JOIN_SDATE ,
		       TO_CHAR(BIZ_JOIN_EDATE,'YYYY-MM-DD') AS BIZ_JOIN_EDATE ,
		       BIZ_TIME,
		       BIZ_PLACE,
		       GUBUN, 
		       COMP_NO_YN,
		       BIZ_TARGET,
		       BIZ_CONTENT,
		       TEMPLATE_GB,
		       TEMPLATE_PATH,
		       REPORT_CONTENT,
		       MOBILE_YN,
		       COMP_NO_YN,
		       DELETE_YN,
		       CREATE_DATE,
		       CREATE_ID,
		       UPDATE_DATE,
		       UPDATE_ID,
		       MTYPE_YN,
		       MTYPE_U_YN,
		       NVL(KOR_FILE_YN,'N') KOR_FILE_YN,
		       NVL(ENG_FILE_YN,'N') ENG_FILE_YN,
		       FILE_NAME1,
		       FILE_TEMP_NAME1,
		       FILE_PATH1,
		       FILE_NAME2,
		       FILE_TEMP_NAME2,
		       FILE_PATH2,
		       FILE_NAME3,
		       FILE_TEMP_NAME3,
		       FILE_PATH3,
		       FILE_NAME4,
		       FILE_TEMP_NAME4,
		       FILE_PATH4,
		       FILE_NAME5,
		       FILE_TEMP_NAME5,
		       FILE_PATH5,
		       FILE_NAME6,
		       FILE_TEMP_NAME6,
		       FILE_PATH6,
		       FILE_NAME7,
		       FILE_TEMP_NAME7,
		       FILE_PATH7,
		       DEPT_CD ,
		       TEMP_YN,                	      -- 임시저장 여부  2012.03.23 hss 
		       NON_TARGET,              	      -- 비회원 참가 여부  2012.04.02 oyh 
		       END_YN,              	 	      -- 마감여부 2012.05.21 hss
		       NVL(END_CNT , '0') END_CNT,              	      -- 마감인원 2012.05.21 hss 
		       NVL((SELECT COUNT(*) FROM BIZ_APPLICATION C WHERE C.BIZ_SEQ= BIZ_MST.BIZ_SEQ ) , '0') REAL_CNT,
		       BIZ_END_YN,              	      -- 공고내리기 2012.05.21 hss  
		       APP_HTML,              	      -- 편집형 신청서 html 2012.11.13
		       EDIT_TYPE_YN,              	      -- 편집형 신청서 여부 2012.11.13  
		       JIBU_CD,              	      -- 편집형 신청서 여부 2012.11.13  
		       COMPLETE_YN,              	      -- 사업마감여부  
		       TXT_TRADEID_YN,              	      -- 무역업번호 추가 여부  
		       TXT_TRADEID_U_YN,              	      -- 무역업번호 필수 여부
		       CONTACT_CD_YN,              	      -- 담당업무 추가여부
		       APP_GUIDE_SMS_EMAIL_YN,              	      -- 담당업무 추가여부
		       TO_CHAR(APP_SMS_RESERVED_DATE,'YYYY-MM-DD HH24:MI') AS APP_SMS_RESERVED_DATE,              	      -- 담당업무 추가여부
		       APP_GUIDE_SMS_CONTENTS,              	      -- sms 내용
		       APP_GUIDE_EMAIL_TITLE,              	      -- 이메일 제목
		       APP_GUIDE_EMAIL_CONTENTS,              	      -- 이메일 내용
		       APP_SMS_RESERVED_CONTENTS,              	      -- 예약문자 내용
		       FILE_YN,              	      -- 첨부파일 유무
		       NVL(CNT,0) CNT,              	      -- 신청자 수
		       NVL(ATTENDANCE_ORDER_NUM,0) ATTENDANCE_ORDER_NUM,        	      -- 참가자 수
		       REPORT_CONTENT_STATUS,
		       REPORT_CONTENT_IMG_HTML,
		       FILE_NAME1_REG,
		       FILE_NAME2_REG,
		       FILE_NAME3_REG,
		       FILE_NAME4_REG,
		       FILE_NAME5_REG,
		       FILE_NAME6_REG,
		       FILE_NAME7_REG,
		       N_INDEX
		FROM BIZ_MST,
		( SELECT BIZ_SEQ B_SEQ, COUNT(APP_SEQ) CNT, MAX(TO_NUMBER(ATTENDANCE_ORDER_NUM)) ATTENDANCE_ORDER_NUM FROM BIZ_APPLICATION group by BIZ_SEQ ) B
		WHERE DELETE_YN = 'N' AND BIZ_SEQ = #{bizSeq}
		AND BIZ_MST.BIZ_SEQ=B.B_SEQ(+)
	</select>
	
	<!-- 신청자상세 편집항목 목록 조회 -->
	<select id="getBizApplicantItemView" parameterType="String" resultType="java.util.HashMap">
		SELECT /* Bsnsreqstinqire.getBizApplicantItemView */
			A.*, B.ITEM_NAME AS APP_ITEM_NAME
		FROM BIZ_APPLICATION_ITEM A, BIZ_APP_ITEM B
		WHERE A.ITEM_SEQ = B.ITEM_SEQ
		AND APP_SEQ = #{appSeq}
		ORDER by b.ITEM_SEQ ASC
	</select>
	
	<!-- 사업신청자 상세-기본정보 -->
	<select id="getBizApplicantView" parameterType="bsnsreqstinqireDetailVO" resultType="java.util.HashMap">
		SELECT /* Bsnsreqstinqire.getBizApplicantView */
			   A.APP_SEQ, A.BIZ_SEQ, A.PERSON_SEQ, A.COMP_NO, A.CORP_KOR_NM, A.CORP_ENG_NM, A.CEO_NM, A.APP_NM,
			   A.PERSON_RESI_NO, A.CELL_NO, A.POZ_NM, A.EMAIL, A.CORP_TEL, A.PROD_NM, A.FAX, A.HOMEPAGE,
			   A.CORP_ADDRESS, A.CORP_TYPE, A.EMP_CNT, A.SALES, A.DELETE_YN,
			   TO_CHAR(A.CREATE_DATE,'YYYY-MM-DD') AS CREATE_DATE, A.CREATE_ID, A.UPDATE_DATE, A.UPDATE_ID,
			   A.CONSULT_AREA, A.UPJONG, A.MEMBER_ID,
			   (SELECT  CODE_NAME FROM CODE_SUB_INFO WHERE CODE_ID = 14 AND CODE1_VALUE = A.UPJONG) AS UPJONG_NM,
			   SOURCE,
				(SELECT BIZ_TITLE FROM BIZ_MST WHERE BIZ_SEQ = A.BIZ_SEQ)  AS BIZ_TITLE,
				(SELECT MTYPE_YN FROM BIZ_MST WHERE BIZ_SEQ = A.BIZ_SEQ)  AS MTYPE_YN,
				(SELECT CODE_NAME FROM CODE_SUB_INFO WHERE CODE_ID = '132' AND CODE1_VALUE = A.MTYPE) AS MTYPE,
				A.FILE_NAME1, A.FILE_PATH1, A.FILE_NAME2, A.FILE_PATH2, A.FILE_NAME3, A.FILE_PATH3,
				A.FILE_NAME4, A.FILE_PATH4, A.FILE_NAME5, A.FILE_PATH5, A.FILE_NAME6, A.FILE_PATH6,
				A.FILE_NAME7, A.FILE_PATH7, A.DEPT, D.CORP_SEQ,
				NVL(B.CONTACT_CD1,0) CONTACT_CD1, NVL(B.CONTACT_CD2,0) CONTACT_CD2, NVL(B.CONTACT_CD3,0) CONTACT_CD3,
				NVL(B.CONTACT_CD4,0) CONTACT_CD4, NVL(B.CONTACT_CD5,0) CONTACT_CD5, NVL(B.CONTACT_CD6,0) CONTACT_CD6,
				NVL(B.CONTACT_CD7,0) CONTACT_CD7,
				E.TXT_TRADEID_YN, E.TXT_TRADEID_U_YN, E.CONTACT_CD_YN
			   FROM BIZ_APPLICATION  A,
		 		(SELECT PERSON_SEQ, MAX(CONTACT_CD1) CONTACT_CD1, MAX(CONTACT_CD2) CONTACT_CD2,
		 				MAX(CONTACT_CD3) CONTACT_CD3, MAX(CONTACT_CD4) CONTACT_CD4,
		 				MAX(CONTACT_CD5) CONTACT_CD5, MAX(CONTACT_CD6) CONTACT_CD6,
		 				MAX(CONTACT_CD7) CONTACT_CD7
		 		   FROM (
		 	    			SELECT 	PERSON_SEQ,
		 	     					DECODE(CONTACT_CD,'001',1,0) CONTACT_CD1
		 	    					,DECODE(CONTACT_CD,'002',1,0) CONTACT_CD2
		 	    					,DECODE(CONTACT_CD,'003',1,0) CONTACT_CD3
		 	    					,DECODE(CONTACT_CD,'004',1,0) CONTACT_CD4
		 	    					,DECODE(CONTACT_CD,'005',1,0) CONTACT_CD5
		 	    					,DECODE(CONTACT_CD,'006',1,0) CONTACT_CD6
		 	    					,DECODE(CONTACT_CD,'007',1,0) CONTACT_CD7
		 	    			  FROM PERSON_CONTACT
		 	    			 WHERE PERSON_SEQ = #{personSeq}
		 				) GROUP BY PERSON_SEQ
		 		) B, PERSON_MST C, CORPORATE_MST D, BIZ_MST E
		   WHERE A.APP_SEQ = #{appSeq}
		     AND A.PERSON_SEQ = B.PERSON_SEQ(+)
		     AND A.PERSON_SEQ = C.PERSON_SEQ(+)
		     AND C.CORP_SEQ = D.CORP_SEQ(+)
		     AND A.BIZ_SEQ = E.BIZ_SEQ
		   ORDER BY A.APP_SEQ DESC
	</select>
	
	<!-- 사업신청자 상세-써브정보(상담회,사절단) -->
	<select id="getBizApplicantViewSub" parameterType="String" resultType="java.util.HashMap">
		SELECT /* Bsnsreqstinqire.getBizApplicantViewSub */
			  A.APP_SEQ, A.CONSEQ
			, A.CORP_KOR_NM, A.CORP_ENG_NM
			, A.MEMBER_ID, A.CEO_KOR_NM
			, A.EMP_CNT, A.UPJONG
			, (SELECT  CODE_NAME from CODE_SUB_INFO WHERE CODE_ID = 14 and CODE1_VALUE = A.UPJONG) as UPJONG_NM
			, A.HOMEPAGE, A.ADDRESS
			, A.EXPORT_SALES, A.IMPORT_SALES
			, A.TRANSLATE_YN, A.BUYER_LIST
			, A.PP_OBJ, A.HOTEL_TYPE
			, A.AIR_TYPE_TEAM, A.AIR_TYPE_PERSON
			, A.REQ_CONTENT, A.DIRECTORY_PATH
			, A.TEMP_FILE_NAME, A.FILE_NAME
			, A.PP_OBJ_ETC
			, B.CONSEQ, B.KOR_NM1
			, B.PERSON_SEQ1 AS CUST_ID, PERSON_SEQ1
			, B.ENG_NM1, B.JIKWI_KOR_NM1
			, B.JIKWI_ENG_NM1, B.TEL1
			, B.FAX1, B.CELL1
			, B.EMAIL1, B.PASSPORT1
			, B.HSCODE1, B.ITEM_KOR_NM1
			, B.ITEM_ENG_NM1, B.ITEM_KOR_CONTENT1
			, B.ITEM_ENG_CONTENT1, B.KOR_NM2
			, B.ENG_NM2, B.JIKWI_KOR_NM2
			, B.JIKWI_ENG_NM2, B.TEL2
			, B.FAX2, B.CELL2
			, B.EMAIL2, B.PASSPORT2
			, B.HSCODE2, B.ITEM_KOR_NM2
			, B.ITEM_ENG_NM2, B.ITEM_KOR_CONTENT2
			, B.ITEM_ENG_CONTENT2, B.KOR_NM3
			, B.ENG_NM3, B.JIKWI_KOR_NM3
			, B.JIKWI_ENG_NM3, B.TEL3
			, B.FAX3, B.CELL3
			, B.EMAIL3, B.PASSPORT3
			, B.HSCODE3, B.ITEM_KOR_NM3
			, B.ITEM_ENG_NM3, B.ITEM_KOR_CONTENT3
			, B.ITEM_ENG_CONTENT3
			, B.APP_GUBUN
		from BIZ_APP_CONSULT A, BIZ_APP_CONSULT_SUB B
		where A.APP_SEQ = B.APP_SEQ
		and A.APP_SEQ = #{appSeq}
		and A.DELETE_YN = 'N'
	</select>
	
	<!-- 사업신청자 상세-마케팅 이력 조회 리스트 -->
	<select id="getBizAppMarketingList" parameterType="bsnsreqstinqireDetailVO" resultType="egovMap">
		SELECT /* Bsnsreqstinqire.getBizAppMarketingList */
		       MAX(B.MEDIA_NO) MEDIA_NO, MAX (A.SEQ) SEQ, A.TRADE_ID TRADE_ID, MAX(A.SERVICE_NM) SERVICE_NM, MAX(A.SERVICE_DESC) SERVICE_DESC, MAX(D.CUST_ID) CUST_ID,
		       MAX(TO_CHAR (A.SERVICE_SDATE, 'YYYY-MM-DD')) SERVICE_SDATE, MAX(TO_CHAR (A.SERVICE_EDATE, 'YYYY-MM-DD')) SERVICE_EDATE,
		       MAX (A.DEPT_CD) DEPT_CD, MAX(GET_USERNM_BY_ID(A.REG_ID )) REG_ID,
		       MAX(DECODE (B.MEDIA_CD, 'S', B.MEDIA_SEND, 0))  SMS,
		       MAX(DECODE (B.MEDIA_CD, 'F', B.MEDIA_SEND, 0))  FAX,
		       MAX(DECODE (B.MEDIA_CD, 'M', B.MEDIA_SEND, 0))  EMAIL,
		       MAX(DECODE (B.MEDIA_CD, 'R', B.MEDIA_SEND, 0))  SVY,
		       MAX(A.UP_CNT) UP_CNT,
		       TO_CHAR (MAX(B.MEDIA_DATE), 'YYYY-MM-DD') AS MEDIA_DATE, TO_CHAR (MAX(C.DEMAND_DATE), 'YYYY-MM-DD') AS DEMAND_DATE,
		       CASE WHEN MAX(B.MEDIA_DATE) > MAX(C.DEMAND_DATE) THEN NVL(MAX(B.MEDIA_DATE),MAX(C.DEMAND_DATE))
		         ELSE NVL(MAX(C.DEMAND_DATE), MAX(B.MEDIA_DATE))  END AS BIGGERDATE,
		       CASE WHEN
		       CASE WHEN  MAX(B.MEDIA_DATE) > MAX(C.DEMAND_DATE) THEN NVL(MAX(B.MEDIA_DATE),MAX(C.DEMAND_DATE))
		         ELSE NVL(MAX(C.DEMAND_DATE), MAX(B.MEDIA_DATE)) END >= (SYSDATE -30)
		       THEN 'P' ELSE 'E' END AS STATUS,
		       GREATEST( MAX (NVL (C.REG_DATE, NVL(C.START_DATE, A.REG_DATE ))), MAX (NVL (B.MEDIA_DATE, A.REG_DATE))) EDATE
		FROM MARKETING_KEY A, MEDIA_LIST B,  MARKETING_LOG C, MEDIA_SEND D, BIZ_APPLICATION E
		WHERE A.TRADE_ID = D.TRADE_ID
		   	AND C.SID = D.TRADE_ID
		 	AND C.POOL_SEQ = D.POOL_SEQ
		 	AND C.SEQ_NO = D.SEQ_NO
		 	AND B.MEDIA_NO = D.MEDIA_NO
		 	AND B.SID = D.TRADE_ID
		 	AND B.POOL_SEQ=D.POOL_SEQ
		 	AND D.CUST_ID = E.PERSON_SEQ
		 	AND E.BIZ_SEQ = #{bizSeq}
		 	AND E.PERSON_SEQ = #{personSeq}
		 	AND C.REG_DATE > E.CREATE_DATE
		GROUP BY A.TRADE_ID , B.POOL_SEQ
		ORDER BY EDATE DESC
	</select>
	
	<!-- 사업신청자 상세-사업신청자목록-Excel 상세(상담회,사절단) -->
	<select id="getBizApplicantExcelDetList" parameterType="String" resultType="egovMap">
		SELECT /* Bsnsreqstinqire.getBizApplicantExcelDetList */
			  A.APP_SEQ
			, A.PERSON_SEQ
			, A.COMP_NO
			, A.CORP_KOR_NM
			, A.CORP_ENG_NM
			, A.CEO_NM
			, A.APP_NM
			, A.PERSON_RESI_NO
			, A.CELL_NO
			, A.EMAIL
			, A.CORP_TEL
			, A.FAX 
			, A.HOMEPAGE
			, A.CORP_ADDRESS
			, A.CORP_TYPE
			, A.CREATE_DATE
			, A.EMP_CNT
			, A.SALES
			, A.UPJONG
			,(SELECT  CODE_NAME from CODE_SUB_INFO WHERE CODE_ID = 14 and CODE1_VALUE = A.UPJONG) as UPJONG_NM
			, A.SOURCE
			, B.CORP_KOR_NM as CORP_KOR_NM_SUB
			, B.CORP_ENG_NM as CORP_ENG_NM_SUB
			, A.MEMBER_ID
			, B.CEO_KOR_NM
			, B.EMP_CNT as EMP_CNT_SUB
			, B.UPJONG as UPJONG_SUB
			,(SELECT  CODE_NAME from CODE_SUB_INFO WHERE CODE_ID = 14 and CODE1_VALUE = B.UPJONG) as UPJONG_SUB_NM
			, B.HOMEPAGE as HOMEPAGE_SUB
			, B.ADDRESS
			, B.EXPORT_SALES
			, B.IMPORT_SALES
			, B.TRANSLATE_YN
			, B.BUYER_LIST
			, B.PP_OBJ
			, B.HOTEL_TYPE
			, B.AIR_TYPE_TEAM
			, B.AIR_TYPE_PERSON
			, B.REQ_CONTENT
			, B.FILE_NAME
			, B.PP_OBJ_ETC
			, C.KOR_NM1
			, C.ENG_NM1
			, C.JIKWI_KOR_NM1
			, C.JIKWI_ENG_NM1
			, C.TEL1
			, C.FAX1
			, C.CELL1
			, C.EMAIL1
			, C.PASSPORT1
			, C.HSCODE1
			, C.ITEM_KOR_NM1
			, C.ITEM_ENG_NM1
			, C.ITEM_KOR_CONTENT1
			, C.ITEM_ENG_CONTENT1
			, C.KOR_NM2
			, C.ENG_NM2
			, C.JIKWI_KOR_NM2
			, C.JIKWI_ENG_NM2
			, C.TEL2
			, C.FAX2
			, C.CELL2
			, C.EMAIL2
			, C.PASSPORT2
			, C.HSCODE2
			, C.ITEM_KOR_NM2
			, C.ITEM_ENG_NM2
			, C.ITEM_KOR_CONTENT2
			, C.ITEM_ENG_CONTENT2
			, C.KOR_NM3
			, C.ENG_NM3
			, C.JIKWI_KOR_NM3
			, C.JIKWI_ENG_NM3
			, C.TEL3
			, C.FAX3
			, C.CELL3
			, C.EMAIL3
			, C.PASSPORT3
			, C.HSCODE3
			, C.ITEM_KOR_NM3
			, C.ITEM_ENG_NM3
			, C.ITEM_KOR_CONTENT3
			, C.ITEM_ENG_CONTENT3
			, A.DEPT
			, A.POZ_NM
			, A.ATTENDANCE_ORDER_NUM
			, A.POZ_NM
			, (select CODE_NAME from code_sub_info where code_id = '93' and code1_value = D.user_fg) USER_FG,
			 (select CODE_NAME from code_sub_info where code_id = '93' and code1_value = G.user_fg) PERSON_FG,
			  DECODE(DECODE(MEMBER_GBN, '1', NVL(P.FEE_ARREAR_YEAR_ALL_CNT, 0), ''), '0', '완납('||(fget_feecnt(p.member_id, nvl(p.reg_re_mem_date,p.reg_date)))||')', '','', P.FEE_ARREAR_YEAR_ALL_CNT||'년미납') AS FEE_CNT, P.REG_MEM_DATE  
			from BIZ_APPLICATION A, BIZ_APP_CONSULT B, BIZ_APP_CONSULT_SUB C, CORPORATE_MST D, PERSON_MST G,  P_DUE3 P
			where  A.APP_SEQ = B.APP_SEQ(+)
				and B.APP_SEQ = C.APP_SEQ(+)
				and A.BIZ_SEQ = #{bizSeq}
				and A.DELETE_YN = 'N'
				 AND A.PERSON_SEQ = G.PERSON_SEQ(+)
				AND G.CORP_SEQ = D.CORP_SEQ(+)
				AND D.MEMBER_ID = P.MEMBER_ID(+)
			order by A.APP_SEQ desc
	</select>
	
	<!-- 사업신청자 상세-사업신청자목록-Excel 상세(상담회,사절단) -->
	<select id="getBizApplicantExcelList" parameterType="bsnsreqstinqireDetailVO" resultType="egovMap">
		SELECT * /* Bsnsreqstinqire.getBizApplicantExcelList */
		FROM (  
		SELECT ROWNUM AS RNUM, AA.*
			FROM (
			SELECT
			       COUNT (1) OVER (PARTITION BY '') TOTALCNT,
			       A.APP_SEQ,
			       A.BIZ_SEQ,
			       A.PERSON_SEQ,
			       A.COMP_NO,
			       NVL(A.CORP_KOR_NM,  (SELECT NVL(CORP_NM, (SELECT CORP_KOR_NM FROM CORPORATE_MST WHERE CORP_SEQ=B.CORP_SEQ )) FROM PERSON_MST B WHERE PERSON_SEQ=A.PERSON_SEQ))  CORP_KOR_NM,
			       A.CORP_ENG_NM,
			       A.CEO_NM,
			       A.APP_NM,
			       A.PERSON_RESI_NO,
			       A.CELL_NO,
			       A.EMAIL,
			       A.CORP_TEL,
			       A.FAX,
			       A.HOMEPAGE,
			       A.CORP_ADDRESS,
			       A.CORP_TYPE,
			       A.EMP_CNT,
			       A.SALES,
			       A.DELETE_YN,
			       A.POZ_NM,
			       TO_CHAR(A.CREATE_DATE,'YYYY-MM-DD') AS CREATE_DATE,
			       A.CREATE_ID,
			       A.UPDATE_DATE,
			       A.UPDATE_ID,
			       A.CONSULT_AREA,
			       A.UPJONG,
			       A.SOURCE,
			       A.FILE_NAME1,
			       A.FILE_PATH1,
			       A.FILE_NAME2,
			       A.FILE_PATH2,
			       A.FILE_NAME3,
			       A.FILE_PATH3,
			       A.FILE_NAME4,
			       A.FILE_PATH4,
			       A.FILE_NAME5,
			       A.FILE_PATH5,
			       A.FILE_NAME6,
			       A.FILE_PATH6,
			       A.FILE_NAME7,
			       A.FILE_PATH7, PROD_NM,
			       NVL(ATTENDANCE_ORDER_NUM, 0) AS ATTENDANCE_ORDER_NUM,
			       A.SATISFACTION_YN,
			       B.KOR_NM1,
			       B.KOR_NM2,
			       B.KOR_NM3,
			       B.PERSON_SEQ1,
			       B.PERSON_SEQ2,
			       B.PERSON_SEQ3,
			       B.JIKWI_KOR_NM1,
			       B.JIKWI_KOR_NM2,
			       B.JIKWI_KOR_NM3,
			       (SELECT BIZ_TITLE FROM BIZ_MST WHERE BIZ_SEQ = A.BIZ_SEQ)  AS BIZ_TITLE,
			       (SELECT MTYPE_YN FROM BIZ_MST WHERE BIZ_SEQ = A.BIZ_SEQ)  AS MTYPE_YN,
			       (SELECT CODE_NAME FROM CODE_SUB_INFO WHERE CODE_ID = '132' AND CODE1_VALUE = A.MTYPE) AS MTYPE,
			       (select CODE_NAME from code_sub_info where code_id = '93' and code1_value = c.user_fg) USER_FG,
			       (select CODE_NAME from code_sub_info where code_id = '93' and code1_value = G.user_fg) PERSON_FG,
			       A.DEPT, 
			       DECODE(DECODE(MEMBER_GBN, '1', NVL(P.FEE_ARREAR_YEAR_ALL_CNT, 0), ''), '0', '완납('||(fget_feecnt(p.member_id, nvl(p.reg_re_mem_date,p.reg_date)))||')', '','', P.FEE_ARREAR_YEAR_ALL_CNT||'년미납') AS FEE_CNT, P.REG_MEM_DATE 
			FROM BIZ_APPLICATION  A,  BIZ_APP_CONSULT_SUB b, CORPORATE_MST C, PERSON_MST G,  P_DUE3 P
			WHERE A.BIZ_SEQ = #{bizSeq}
			  AND A.APP_SEQ = B.APP_SEQ(+)
			  AND A.PERSON_SEQ = G.PERSON_SEQ(+)
			     AND G.CORP_SEQ = C.CORP_SEQ(+)
			     AND C.MEMBER_ID = P.MEMBER_ID(+)
			     <if test='schCorpKorNm != null and schCorpKorNm != ""'>
	            	AND CORP_KOR_NM LIKE #{schCorpKorNm}||'%'
	            </if>
	            <if test='schAppNm != null and schAppNm != ""'>
	            	AND APP_NM LIKE #{schAppNm}||'%'
	            </if>
	            <if test='personResiNo != null and personResiNo != ""'>
	            	AND PERSON_RESI_NO = #{personResiNo}
	            </if>
	            <if test='personEmail != null and personEmail != ""'>
	            	AND EMAIL LIKE #{personEmail}||'%'
	            </if>
	            <if test='cellNo != null and cellNo != ""'>
	            	AND CELL_NO LIKE '%'||#{cellNo}||'%'
	            </if>
	ORDER BY APP_SEQ DESC 
			       ) AA
		       ) BB
	</select>
	
	<!-- 신청자상세 편집항목 아이템명 조회 -->
	<select id="getBizApplicantItemName" parameterType="String" resultType="egovMap">
		SELECT /* Bsnsreqstinqire.getBizApplicantItemName */
			A.item_seq, B.ITEM_NAME AS APP_ITEM_NAME
		FROM BIZ_APPLICATION_ITEM A, BIZ_APP_ITEM B, BIZ_APPLICATION C
		WHERE A.ITEM_SEQ = B.ITEM_SEQ   AND a.APP_SEQ = c.app_seq
		AND c.biz_seq  = #{bizSeq}
		group by A.item_seq, B.ITEM_NAME
		order by A.item_seq asc
	</select>
	
	<!--사업완료 및 업로드 엑셀 내 신청자를 참가자로 변경처리 기능-->
	<select id="getBizAttendanceComplete" parameterType="bsnsreqstinqireDetailVO" resultType="egovMap">
		SELECT /* Bsnsreqstinqire.getBizAttendanceComplete */
			BA.BIZ_SEQ,
			BA.APP_SEQ AS APP_SEQ,
			BA.PERSON_SEQ	 AS PERSON_SEQ,
			BA.APP_NM AS APP_NM,
			BA.CELL_NO AS CELL_NO,
			BA.EMAIL AS EMAIL,
			BACS.APP_SEQ AS APP_SEQ1,
			BACS.PERSON_SEQ1 AS PERSON_SEQ1,
			BACS.KOR_NM1 AS APP_NM1,
			BACS.CELL1 AS CELL_NO1,
			BACS.EMAIL1 AS EMAIL1,
			BA.ATTENDANCE_ORDER_NUM
		FROM
			BIZ_MST	BM,
			BIZ_APPLICATION	BA,
			BIZ_APP_CONSULT_SUB BACS
		WHERE
			BA.BIZ_SEQ = #{bizSeq}
			AND BA.BIZ_SEQ = BM.BIZ_SEQ
			AND BA.APP_SEQ = BACS.APP_SEQ(+)
			<choose><when test='searchType=="1"'>
				<choose><when test='compNo != null and compNo != ""'>
		AND REPLACE(BA.COMP_NO, '-', '') = REPLACE(#{compNo}, '-', '')
        		</when><otherwise>
        		<if test='corpKorNm != null and corpKorNm != ""'>
    		AND BA.CORP_KOR_NM = #{corpKorNm}
    			</if>
    			<if test='ceoNm != null and ceoNm != ""'>
    		AND BA.CEO_NM = #{ceoNm}
    			</if>
        		</otherwise></choose>
        		<if test='appNm != null and appNm != ""'>
		AND (BA.APP_NM = #{appNm} OR BACS.KOR_NM1 = #{appNm})
				</if>
				<choose><when test='cellNo != null and cellNo != ""'>
		AND (REPLACE(BA.CELL_NO, '-', '') = REPLACE(#{cellNo}, '-', '')
		OR	REPLACE(BACS.CELL1, '-', '') = REPLACE(#{cellNo}, '-', ''))
        		</when><otherwise>
        		<if test='email != null and email != ""'>
    		AND (BA.EMAIL = #{email} OR BACS.EMAIL1 = #{email})
				</if>
        		</otherwise></choose>
			</when><when test='searchType=="2"'>
				<choose><when test='compNo != null and compNo != ""'>
		AND REPLACE(BA.COMP_NO, '-', '') = REPLACE(#{compNo}, '-', '')
    			</when><otherwise>
    			<if test='corpKorNm != null and corpKorNm != ""'>
    		AND BA.CORP_KOR_NM = #{corpKorNm}
    			</if>
    			</otherwise></choose>
        		<if test='appNm != null and appNm != ""'>
		AND (BA.APP_NM = #{appNm} OR BACS.KOR_NM1 = #{appNm})
				</if>
			</when></choose>
	</select>
	
	<!-- 신청자목록 참가자 제외 업데이트 -->
	<update id="updateBizApplication" parameterType="bsnsreqstinqireDetailVO">
			UPDATE /* Bsnsreqstinqire.updateBizApplication */
				BIZ_APPLICATION
				SET	   	UPDATE_DATE = SYSDATE,
				    	UPDATE_ID = #{userId},
				    	DELETE_YN = DECODE(DELETE_YN, 'N', 'Y', 'N'),
				    	ATTENDANCE_ORDER_NUM = ''
				WHERE APP_SEQ  IN (
				<foreach collection="seqList" item="item" index="index" separator=",">
		              #{item}
		         </foreach>
				)
	</update>
	
	<!-- 제외 참가자 삭제 -->
	<delete id="deleteBizApplication" parameterType="bsnsreqstinqireDetailVO">
		DELETE /* Bsnsreqstinqire.deleteBizApplication */
		 FROM BIZ_APPLICATION
		WHERE APP_SEQ IN (
		<foreach collection="seqList" item="item" index="index" separator=",">
              #{item}
         </foreach>
		)
	</delete>
	
	 <!-- 사업완료 취소 -->
	<update id="updateBizCompleteYnCancel" parameterType="String">
			UPDATE /* Bsnsreqstinqire.updateBizCompleteYnCancel */
			BIZ_MST
				SET COMPLETE_YN = 'N'
				WHERE BIZ_SEQ 	= #{bizSeq}
	</update>
	
	
	
	
</mapper>
